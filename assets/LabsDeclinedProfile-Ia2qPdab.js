import{H as B,k as L,r as o,V as u,h as m,j as e,m as D,A as y,g as P}from"./index-Bpiqhjgz.js";import{h as S,T as F}from"./hasRequiredRole-DdcWnXRY.js";import{B as T}from"./ButtonClipLoader-CMWX1BTK.js";import{N as q}from"./no-image-icon-Dam8WiVQ.js";import{I as $,a as E}from"./IsLoading-YL9L8z0m.js";import{N as I}from"./NoData-CKGSm1D0.js";import{f as V}from"./index-C0jXtD0D.js";import"./Status-BWexfZul.js";/* empty css                  */import"./index-DC3BKKND.js";import"./index-BOhMR0xG.js";function H(){var n,x,c;const{id:p}=B(),r=["fetch-declined-lab-details",{id:p}],{isLoading:N,isError:f,data:i,error:d}=L({queryKey:r,queryFn:()=>y.get(`/lab/${p}`)}),[s,h]=o.useState((x=(n=i==null?void 0:i.data)==null?void 0:n.data)==null?void 0:x.doc);return o.useEffect(()=>{var g,v;i&&h((v=(g=i==null?void 0:i.data)==null?void 0:g.data)==null?void 0:v.doc),d&&u.error(m(d))},[i,d]),e.jsx(e.Fragment,{children:N?e.jsx($,{}):f?e.jsx(E,{}):!s||((c=Object.keys(s))==null?void 0:c.length)===0?e.jsx(I,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsx("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:e.jsx("p",{className:"font-[600] text-[20px]",children:"Details"})}),e.jsxs("div",{className:"flex flex-col",children:[s!=null&&s.image?e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Logo"}),e.jsx("div",{className:"w-[100px] h-[100px] rounded-[10px] bg-[#f1f5f9]",children:e.jsx("a",{href:s!=null&&s.image?`${D}/${s==null?void 0:s.image}`:q,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:s!=null&&s.image?`${D}/${s==null?void 0:s.image}`:q,alt:"education logo",className:"inline-flex w-full h-full object-cover"})})})]}):"",e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Lab Name"}),e.jsx("p",{children:(s==null?void 0:s.title)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Phone"}),e.jsx("p",{children:s==null?void 0:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Email"}),e.jsx("p",{children:s==null?void 0:s.email})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Country"}),e.jsx("p",{children:(s==null?void 0:s.countryName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"City"}),e.jsx("p",{children:(s==null?void 0:s.city)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4",children:[e.jsx("p",{children:"State/Province"}),e.jsx("p",{children:(s==null?void 0:s.province)||"N/A"})]})]})]})})})}function K(){var w,A;const{id:p}=B(),r=["fetch-declined-lab-documents",{id:p}],{isLoading:N,data:f,isError:i,error:d}=L({queryKey:r,queryFn:()=>y.get(`/know-your-customer/?labObjectId=${p}`)}),[s,h]=o.useState(!1),[n,x]=o.useState(!1),c=(A=(w=f==null?void 0:f.data)==null?void 0:w.data)==null?void 0:A.docs;o.useEffect(()=>{d&&u.error(m(d))},[f,d]);const g=async a=>{var j;h(!0);try{const{data:l}=await y.patch(`/know-your-customer/approve/${a==null?void 0:a._id}`,{status:"Approved",statusChangeReason:"Verification Successful"});l!=null&&l.success&&u.success((l==null?void 0:l.message)||((j=l==null?void 0:l.data)==null?void 0:j.message))}catch(l){u.error(m(l))}finally{h(!1)}},v=async a=>{var j;x(!0);try{const{data:l}=await y.patch(`/know-your-customer/approve/${a==null?void 0:a._id}`,{status:"Declined",statusChangeReason:"Verification Failed"});l!=null&&l.success&&u.success((l==null?void 0:l.message)||((j=l==null?void 0:l.data)==null?void 0:j.message))}catch(l){u.error(m(l))}finally{x(!1)}};return e.jsx(e.Fragment,{children:N?e.jsx($,{}):i?e.jsx(E,{}):!c||(c==null?void 0:c.length)===0?e.jsx(I,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:c==null?void 0:c.map((a,j)=>e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsxs("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{className:"font-[600] text-[20px]",children:"Document"}),e.jsxs("div",{className:"flex max-[370px]:flex-col max-[370px]:w-full max-[370px]:items-start items-center gap-4",children:[e.jsx("div",{className:"max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center gap-1 bg-fullGreen w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>g(a),disabled:s,children:s?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(T,{}),"Please Wait"]}):"Approve"})}),e.jsx("div",{className:" max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"bg-fullRed w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>v(a),disabled:n,children:n?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(T,{}),"Please Wait"]}):"Decline"})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Identification Type"}),e.jsx("p",{children:(a==null?void 0:a.identificationDocumentType)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Business Name"}),e.jsx("p",{children:(a==null?void 0:a.businessName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Lab License"}),e.jsx("p",{children:(a==null?void 0:a.businessLicense)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Business Address"}),e.jsx("p",{children:(a==null?void 0:a.businessAddress)||"N/A"})]}),a!=null&&a.businessIdentificationDocument?e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4",children:[e.jsx("p",{children:"Business Identification Document"}),e.jsx("div",{className:"w-[100px] h-[100px] rounded-[10px] bg-[#f1f5f9]",children:e.jsx("a",{href:`${D}/${a==null?void 0:a.businessIdentificationDocument}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:`${D}/${a==null?void 0:a.businessIdentificationDocument}`,alt:"logo",className:"inline-flex w-full h-full object-cover"})})})]}):""]})]},j))})})}function U(){const{id:p}=B(),r=["fetch-declined-lab-services",{id:p}],{isLoading:N,isError:f,data:i,error:d}=L({queryKey:r,queryFn:()=>y.get(`/offered-lab-test?labHeadOffice=${p}`)}),[s,h]=o.useState([]);return o.useEffect(()=>{var n,x;i&&h((x=(n=i==null?void 0:i.data)==null?void 0:n.data)==null?void 0:x.docs),d&&u.error(m(d))},[i,d]),e.jsx(e.Fragment,{children:N?e.jsx($,{}):f?e.jsx(E,{}):!s||(s==null?void 0:s.length)===0?e.jsx(I,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:s==null?void 0:s.map((n,x)=>{var c;return e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsx("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:e.jsx("p",{className:"font-[600] text-[20px]",children:"Lab Test"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Test Name"}),e.jsx("p",{children:(n==null?void 0:n.title)||((c=n==null?void 0:n.labTest)==null?void 0:c.title)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4",children:[e.jsx("p",{children:"Price"}),e.jsxs("p",{children:[e.jsx("span",{children:(n==null?void 0:n.currencyCode)==="USD"?"$":""}),e.jsx("span",{children:n!=null&&n.price?parseFloat(n==null?void 0:n.price).toFixed(2):"N/A"})]})]})]})]},x)})})})}const C=[{id:1,name:"Lab Tests",requiredRoles:["admin"]},{id:2,name:"Personal Details",requiredRoles:["admin"]},{id:3,name:"Documents",requiredRoles:["admin"]}];function ee(){var k,R;const{id:p}=B(),[r,N]=o.useState({}),[f,i]=o.useState(!1),[d,s]=o.useState(!1),h=P(),n=h==null?void 0:h.roles,x=o.useMemo(()=>n,[]),[c,g]=o.useState(1),v=["fetch-in-review-lab-profile-data",{id:p}],{data:w,error:A}=L({queryKey:v,queryFn:()=>y.get(`/lab/${p}`)});o.useEffect(()=>{if(w){const{data:{data:{doc:b}}}=w;N(b)}A&&u.error(m(A))},[w,A]),o.useEffect(()=>{const b=C.find(t=>S(t.requiredRoles,x));b?g(b.id):(u.error("User has no access to any tabs"),g(null))},[x]);const a={profileName:(r==null?void 0:r.title)||(r==null?void 0:r.fullName)||((k=r==null?void 0:r.user)==null?void 0:k.username)||e.jsxs("span",{children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]})||"N/A",profileImage:(r==null?void 0:r.image)||((R=r==null?void 0:r.user)==null?void 0:R.image),phone:V(r==null?void 0:r.phone)||"N/A",email:(r==null?void 0:r.email)||"N/A",country:(r==null?void 0:r.countryName)||"N/A",state:(r==null?void 0:r.province)||"N/A",city:(r==null?void 0:r.city)||"N/A",address:(r==null?void 0:r.address)||"",status:(r==null?void 0:r.status)||""},j=async()=>{var b;i(!0);try{const{data:t}=await y.patch(`/lab/approve/${p}`,{status:"Approved",statusChangeReason:"Passed all tests"});t!=null&&t.success&&u.success((t==null?void 0:t.message)||((b=t==null?void 0:t.data)==null?void 0:b.message))}catch(t){u.error(m(t))}finally{i(!1)}},l=async()=>{var b;s(!0);try{const{data:t}=await y.patch(`/lab/approve/${p}`,{status:"Declined",statusChangeReason:"Failed all tests"});t!=null&&t.success&&u.success((t==null?void 0:t.message)||((b=t==null?void 0:t.data)==null?void 0:b.message))}catch(t){u.error(m(t))}finally{s(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex max-[450px]:flex-col gap-3 items-center justify-between",children:[e.jsx("h1",{className:"main-heading",children:"Lab Profile"}),e.jsx("div",{children:e.jsx("button",{className:"inline-flex items-center gap-[8px] px-[12px] py-[8px] bg-[#624DE3] rounded-[8px] font-[600] text-white cursor-pointer",children:e.jsx("span",{children:"Edit Lab"})})})]}),c!==null&&e.jsx(F,{activeTab:c,setActiveTab:g,roles:x,hasRequiredRole:S,tabs:C,profileData:a,button1Label:"Approve",button1Handler:j,submitting1:f,button2Label:"Decline",button2Handler:l,submitting2:d}),e.jsxs("div",{className:"",children:[c===1?e.jsx(U,{}):"",c===2?e.jsx(H,{}):"",c===3?e.jsx(K,{}):""]})]})})}export{ee as default};
