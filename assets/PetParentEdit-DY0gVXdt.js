import{C as z,j as e,D as C,G as H,r as c,k as L,c as S,H as Q,a as u,l as T,F as I,b as q,m as w,q as p,S as D,A as j,V as x,h as A,p as k,P,Y as K,y as _}from"./index-90C_iGnH.js";import{H as J}from"./HeadingPlusBackBtn-BmGkcs0Z.js";import{h as f}from"./moment-C5S46NFB.js";import{i as W,a as X}from"./index-BZFQK5FB.js";import{P as N}from"./apiEndpoints-DA67aB0N.js";import{I as B}from"./Input-NYo6jH4B.js";import{C as Z}from"./CountrySearchInput-NmGWSVL7.js";import{S as ee,C as se}from"./CitySearchInput-DJwWBr5J.js";import{A as re}from"./AddressInput-CCZMpOW0.js";import{S as ae}from"./SingleImageUpload-D-v9muW8.js";import{P as te}from"./PhoneInput-C3xAMeSO.js";import{S as ie}from"./SelectComponent-oerRb_Cn.js";import{g as le}from"./index-BiCNRH9L.js";import"./BackButton-CkQpbmPE.js";import"./index-DN2uC23I.js";import"./index-YtPAdDxb.js";import"./index.modern-DR-aB_7J.js";import"./index-nI4YGiSl.js";import"./index-EwOyO1A0.js";import"./no-image-icon-CabPHXKl.js";function ne({...t}){const[l,i,m]=z(t),o=l.value?f(l.value).format("YYYY-MM-DD"):"",h=d=>{const a=d.target.value;m.setValue(a?f(a).toDate():null)};return e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("label",{htmlFor:t.id||t.name,className:"text-[18px] font-[500] text-[#252C62]",children:"Date of Birth"}),e.jsx("input",{...t,type:"date",value:o,onChange:h,onBlur:l.onBlur,onFocus:d=>{l.onBlur(d),d.target.showPicker()},className:"h-10 px-3 py-2 rounded-md bg-white border border-lightBlue text-darkBlue focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",max:f().format("YYYY-MM-DD")}),i.touched&&i.error?e.jsx("div",{className:"text-red-500 text-sm",children:i.error}):null]})}function oe(){const{id:t}=C(),l=H(),[i,m]=c.useState(""),[o,h]=c.useState(""),[d,a]=c.useState(""),[y,F]=c.useState("");c.useEffect(()=>{if(i){const r=new Intl.DisplayNames(["en"],{type:"region"});h(r.of(i))}},[i]);const O=async()=>t?(await j.get(`${N}/${t}`)).data.data.doc:null,{data:s,isLoading:$,isError:Y,error:E}=L({queryKey:["petParent",t],queryFn:O,enabled:!!t,staleTime:5*60*1e3,cacheTime:30*60*1e3});c.useEffect(()=>{s&&(m(le(s==null?void 0:s.countryCode)||(s==null?void 0:s.countryCode)||""),a((s==null?void 0:s.province)||""))},[s]);const G=()=>{var r;return{imageDataURI:null,fullName:(s==null?void 0:s.fullName)||((r=s==null?void 0:s.user)==null?void 0:r.username)||"",email:(s==null?void 0:s.email)||"",countryName:(s==null?void 0:s.countryName)||"",province:(s==null?void 0:s.province)||"",city:(s==null?void 0:s.city)||"",address:(s==null?void 0:s.address)||"",phone:(s==null?void 0:s.phone)||"",bloodGroup:(s==null?void 0:s.bloodGroup)||"",dateOfBirth:s!=null&&s.dateOfBirth?f(s.dateOfBirth).toDate():null}},R=S().shape({imageDataURI:T().nullable().test("fileSize","Image size must be less than 4MB",r=>r===null||r instanceof File&&r.size<=4*1024*1024).test("fileFormat","Accepted formats are jpg, png",r=>r===null||r instanceof File&&["image/jpeg","image/png"].includes(r.type)).required("Image is required"),fullName:u().required("Full Name is required"),email:u().email("Please enter valid email").required("Email is required"),countryName:u().required("Country Name is required"),province:u().optional(),city:u().optional(),address:u().required("Address is required"),phone:u().test("is-possible-phone","Please enter valid phone number",r=>r?W(r):!0).test("is-valid-phone","Please enter valid phone number",r=>r?X(r):!0).required("Phone is required"),bloodGroup:u().oneOf(["A+","A-","B+","B-","AB+","AB-","O+","O-"],"Please select valid blood group").required("Blood Group is required"),dateOfBirth:Q().nullable().max(new Date,"Date of Birth cannot be in the future").required("Date of Birth is required")}),V=[{label:"A+",value:"A+"},{label:"A-",value:"A-"},{label:"B+",value:"B+"},{label:"B-",value:"B-"},{label:"AB+",value:"AB+"},{label:"AB-",value:"AB-"},{label:"O+",value:"O+"},{label:"O-",value:"O-"}],M=async r=>{var v;const{email:b,bloodGroup:g,...U}=r;try{const{data:n}=await j.patch(`${N}/${t}`,{...U,imageDataURI:y,dateOfBirth:f(r==null?void 0:r.dateOfBirth).format("YYYY-MM-DD"),countryCode:i});n!=null&&n.success&&(x.success(((v=n==null?void 0:n.data)==null?void 0:v.message)||(n==null?void 0:n.message)),l.invalidateQueries(["petParent",t]))}catch(n){x.error(A(n))}};return $?e.jsx("div",{className:"flex justify-center items-center h-64 text-darkBlue",children:"Loading profile data..."}):Y?e.jsxs("div",{className:"flex justify-center items-center h-64 text-red-500",children:["Error loading profile: ",E.message]}):s?e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(I,{initialValues:G(),validationSchema:R,onSubmit:M,enableReinitialize:!0,children:r=>{var b,g;return e.jsxs(q,{className:"flex flex-col gap-3 p-5 bg-white rounded-[20px] border border-lightBlue shadow",autoComplete:"off",children:[e.jsx("p",{className:"text-xl text-darkBlue font-[500] border-b border-b-lightBlue pb-2",children:"Profile Settings"}),e.jsx("div",{className:"",children:e.jsx(ae,{formik:r,name:"imageDataURI",id:"imageDataURI",label:"Profile Image",base64Image:y,setBase64Image:F,backendImage:(b=s==null?void 0:s.user)!=null&&b.image?`${w}/${(g=s==null?void 0:s.user)==null?void 0:g.image}`:s!=null&&s.image?`${w}/${s==null?void 0:s.image}`:""})}),e.jsxs(p,{children:[e.jsx("div",{className:"w-full",children:e.jsx(B,{formik:r,name:"fullName",id:"fullName",label:"Full Name"})}),e.jsx("div",{className:"w-full",children:e.jsx(B,{formik:r,name:"email",id:"email",label:"Email",disabled:!0})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"w-full",children:e.jsx(Z,{formik:r,name:"countryName",id:"countryName",label:"Country",getCountryCode:m})}),e.jsx("div",{className:"w-full",children:e.jsx(ee,{formik:r,name:"province",id:"province",label:"State/Province",countryName:o,getStateName:a})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"w-full",children:e.jsx(se,{formik:r,name:"city",id:"city",label:"City",countryName:o,stateName:d})}),e.jsx("div",{className:"w-full",children:e.jsx(re,{formik:r})})]}),e.jsxs(p,{children:[e.jsx("div",{className:"w-full",children:e.jsx(te,{name:"phone",id:"phone",label:"Phone",country:i})}),e.jsx("div",{className:"w-full",children:e.jsx(ie,{formik:r,name:"bloodGroup",id:"bloodGroup",label:"Blood Group",options:V,disabled:!0})})]}),e.jsx(p,{children:e.jsx("div",{className:"w-full",children:e.jsx(ne,{name:"dateOfBirth",id:"dateOfBirth"})})}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{formik:r})})]})}})})}):e.jsx("div",{className:"flex justify-center items-center h-64 text-gray-500",children:"No profile data found for this ID."})}K(_);function ue(){const{id:t}=C(),l={password:"",confirmPassword:""},i=S().shape({password:u().required("Current Password is required"),confirmPassword:u().oneOf([k("password"),null],"Passwords do not match").required("Confirm password is required")}),m=async(o,{resetForm:h})=>{var d;try{const{data:a}=await j.patch(`${N}/update-password/${t}`,o);a!=null&&a.success&&(x.success(((d=a==null?void 0:a.data)==null?void 0:d.message)||(a==null?void 0:a.message)),h())}catch(a){x.error(A(a))}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(I,{initialValues:l,validationSchema:i,onSubmit:m,enableReinitialize:!0,children:o=>e.jsxs(q,{className:"flex flex-col gap-3 p-5 bg-white rounded-[20px] border border-lightBlue shadow",children:[e.jsxs(p,{children:[e.jsx("div",{className:"w-full",children:e.jsx(P,{formik:o,name:"password",id:"password",label:"New Password"})}),e.jsx("div",{className:"w-full",children:e.jsx(P,{formik:o,name:"confirmPassword",id:"confirmPassword",label:"Confirm Password"})})]}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{formik:o})})]})})})})}function De(){const[t,l]=c.useState("profile"),i=m=>`cursor-pointer px-4 py-2 rounded-md transition-colors ${t===m?"bg-myBlue text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`;return e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{children:e.jsx(J,{label:"Edit Pet Parent"})}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("button",{type:"button",className:i("profile"),onClick:()=>l("profile"),children:"Profile"}),e.jsx("button",{type:"button",className:i("password"),onClick:()=>l("password"),children:"Change Password"})]}),e.jsx("div",{children:t==="profile"?e.jsx(oe,{}):e.jsx(ue,{})})]})}export{De as default};
