import{r as l,u as q,j as e,A as d,V as t,b as u}from"./index-BGHtLGIu.js";import{c as C,g,a as i,f as S,F as A,b as E,y as I}from"./index.esm-C_c1U5EP.js";import{Y as R}from"./index-BBAJCH2C.js";import{i as F,a as U,P as V}from"./PhoneInput-C1phW-SY.js";import{H as B}from"./HeadingPlusBackBtn-CBQMc0Jd.js";import{S as $}from"./SubmitButton-Dtzo-OYt.js";import{I as m}from"./Input-CeADRMM0.js";import{L as n}from"./LayoutDiv-VwZNTzL9.js";import{P as c}from"./PasswordInput-BJz7t9vT.js";import{M as H}from"./MultSelectBox-irOwFUay.js";import{C as M}from"./CountrySearchInput-Cxxc4Y6J.js";import{g as D}from"./index-DKX3qbAv.js";import"./index-BwYmHd0V.js";import"./index-BtNt5WtL.js";R(I);function ee(){const[o,p]=l.useState(""),[f,h]=l.useState(""),[x,N]=l.useState([]),j=q();l.useEffect(()=>{(async()=>{try{const{data:a}=await d.get("/admin/role");if(a!=null&&a.success){const{data:{doc:r}}=a;if(r){const P=r==null?void 0:r.map(v=>v.name);N(P)}}}catch(a){t.error(u(a))}})()},[]),l.useEffect(()=>{if(o){const s=new Intl.DisplayNames(["en"],{type:"region"});h(s.of(o))}},[o]);const w={fullName:"",username:"",email:"",password:"",confirmPassword:"",phone:"",countryName:"",roles:[]},y=C().shape({fullName:i().required("Full Name is required"),username:i().required("Username is required"),email:i().email().required("Email is required"),password:i().password().required("Password is required"),confirmPassword:i().oneOf([S("password"),null],"Passwords do not match").required("Confirm password is required"),phone:i().test("is-possible-phone","Please enter valid phone number",s=>F(s)).test("is-valid-phone","Please enter valid phone number",s=>U(s)).required("Phone Number is required"),countryName:i().required("Country is required"),roles:g().min(1,"At least one role is required").required("Role is required")}),b=async(s,{setSubmitting:a})=>{a(!0);try{const{data:r}=await d.post("/admin/admin-user/",{...s,countryName:f,countryCode:D(o)});r!=null&&r.success&&(t.success((r==null?void 0:r.message)||"User Created Successfully"),j("/admin-users"))}catch(r){t.error(u(r))}finally{a(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{className:"",children:e.jsx(B,{label:"Add Admin User"})}),e.jsx("div",{className:"rounded-[20px] bg-white p-5",children:e.jsx(A,{initialValues:w,validationSchema:y,onSubmit:b,enableReinitialize:!0,children:s=>e.jsxs(E,{className:"flex flex-col gap-3",autoComplete:"off",children:[e.jsxs(n,{children:[e.jsx("div",{className:"w-full",children:e.jsx(m,{formik:s,name:"fullName",id:"fullName",label:"Full Name"})}),e.jsx("div",{className:"w-full",children:e.jsx(m,{formik:s,name:"username",id:"username",label:"Username"})})]}),e.jsxs(n,{children:[e.jsx("div",{className:"w-full",children:e.jsx(m,{formik:s,name:"email",id:"email",label:"Email"})}),e.jsx("div",{className:"w-full",children:e.jsx(H,{formik:s,name:"roles",id:"roles",label:"Role",options:x})})]}),e.jsxs(n,{children:[e.jsx("div",{className:"w-full",children:e.jsx(c,{formik:s,name:"password",id:"password",label:"Password"})}),e.jsx("div",{className:"w-full",children:e.jsx(c,{formik:s,name:"confirmPassword",id:"confirmPassword",label:"Confirm Password"})})]}),e.jsxs(n,{children:[e.jsx("div",{className:"w-full",children:e.jsx(M,{formik:s,name:"countryName",id:"countryName",label:"Country",getCountryCode:p})}),e.jsx("div",{className:"w-full",children:e.jsx(V,{name:"phone",id:"phone",label:"Phone",country:o})})]}),e.jsx("div",{className:"mt-2",children:e.jsx($,{formik:s})})]})})})]})})}export{ee as default};
