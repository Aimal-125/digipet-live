import{r as n,j as u,E as F}from"./index-DH_9BMEQ.js";const N=({formik:s,name:o="",id:m="",label:C="",getCountryCode:v=()=>{}})=>{const[S,h]=n.useState(""),[i,b]=n.useState([]),[l,f]=n.useState([]),[y,r]=n.useState(!1),[a,c]=n.useState(-1),p=n.useRef(null),d=n.useRef(null);n.useEffect(()=>{(async()=>{try{const t=await fetch("https://restcountries.com/v3.1/all?fields=name,cca2,cca3");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const w=(await t.json()).map(x=>({name:x.name.common,cca2:x.cca2,cca3:x.cca3}));b(w)}catch(t){console.error("Error fetching countries:",t)}})()},[]),n.useEffect(()=>{const e=s.values[o];e&&typeof e=="string"&&e.name?h(e.name):e||h("")},[s.values,o]);const j=e=>{const t=e.target.value;if(h(t),c(-1),t.length>0){const g=i.filter(w=>w.name.toLowerCase().includes(t.toLowerCase()));f(g),r(!0)}else f([]),r(!1)},E=e=>{h(e.name),console.log("Selected Country:",e),v(e.cca2),s.setFieldValue(o,e.name),f([]),r(!1),c(-1),s.setFieldTouched(o,!0)},D=e=>{y&&(e.key==="ArrowUp"?(e.preventDefault(),c(t=>t<=0?l.length-1:t-1)):e.key==="ArrowDown"?(e.preventDefault(),c(t=>t===l.length-1?0:t+1)):e.key==="Enter"?(e.preventDefault(),a>=0&&a<l.length&&E(l[a])):e.key==="Escape"&&(r(!1),c(-1),s.setFieldTouched(o,!0)))};return n.useEffect(()=>{const e=t=>{p.current&&!p.current.contains(t.target)&&d.current&&!d.current.contains(t.target)&&(r(!1),c(-1),s.setFieldTouched(o,!0))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s,o]),n.useEffect(()=>{if(a!==-1&&d.current){const e=d.current.children[a];e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}},[a]),u.jsxs("div",{className:"relative flex flex-col gap-3",children:[C&&u.jsx("label",{htmlFor:m,className:"block text-[18px] font-[500] text-[#252C62]",children:C}),u.jsx("input",{ref:p,type:"text",id:m,name:o,value:s==null?void 0:s.values[o],onChange:e=>{s.handleChange(e),j(e)},onKeyDown:D,onFocus:()=>{if(S.length>0&&i.length>0){const e=i.filter(t=>t.name.toLowerCase().includes(S.toLowerCase()));f(e),r(!0)}else i.length>0&&(f(i),r(!0))},onBlur:e=>{s.handleBlur(e),setTimeout(()=>{r(!1),c(-1)},100)},placeholder:"Search for a country...",className:"border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full"}),y&&l.length>0&&u.jsx("ul",{ref:d,className:"absolute left-0 top-[100%] z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto shadow-lg",children:l.map((e,t)=>u.jsx("li",{className:`px-4 py-2 cursor-pointer ${t===a?"bg-blue-100":"hover:bg-gray-100"}`,onClick:()=>E(e),onMouseDown:g=>g.preventDefault(),children:e.name},e.cca2||t))}),u.jsx(F,{name:o,component:"div",className:"text-red-500 text-sm mt-1"})]})};export{N as C};
