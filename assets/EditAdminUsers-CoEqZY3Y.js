import{_ as R,r as n,u as B,V as m,b as f,j as e,A as h}from"./index-BGHtLGIu.js";import{c as V,a as i,g as $,f as O,F as U,b as D,y as H}from"./index.esm-C_c1U5EP.js";import{H as M}from"./HeadingPlusBackBtn-CBQMc0Jd.js";import{L as u}from"./LayoutDiv-VwZNTzL9.js";import{I as x}from"./Input-CeADRMM0.js";import{M as L}from"./MultSelectBox-irOwFUay.js";import{P as w}from"./PasswordInput-BJz7t9vT.js";import{i as Y,a as z,P as K}from"./PhoneInput-C1phW-SY.js";import{S as Q}from"./SubmitButton-Dtzo-OYt.js";import{Y as _}from"./index-BBAJCH2C.js";import{C as G}from"./CountrySearchInput-Cxxc4Y6J.js";import{u as J}from"./useQuery-BzOiPmuN.js";/* empty css                  */import{g as T}from"./index-DKX3qbAv.js";import{g as W}from"./index-CZbMfi2Y.js";import{S as X}from"./SelectComponent-Cwy97yns.js";import"./index-BtNt5WtL.js";import"./index-BwYmHd0V.js";_(H);function xe(){const{id:d}=R(),[a,v]=n.useState({}),[o,N]=n.useState(""),[b,j]=n.useState(""),[P,g]=n.useState([]),q=B(),y=[{label:"Pending",value:"Pending"},{label:"Active",value:"Active"},{label:"Blocked",value:"Blocked"}],C=y.map(s=>s.value),S=["fetch-admin-user-by-id",{id:d}],{data:c,error:p}=J({queryKey:S,queryFn:()=>h.get(`/admin/admin-user/${d}`)});n.useEffect(()=>{if(c){const{data:{data:{doc:s}}}=c;v(s),j(s==null?void 0:s.countryName),N(W(s==null?void 0:s.countryCode))}p&&m.error(f(p))},[c,p]),n.useEffect(()=>{(async()=>{try{const{data:t}=await h.get("/admin/role");if(t!=null&&t.success){const{data:{doc:l}}=t;if(l){const r=l==null?void 0:l.map(F=>F.name);g(r)}}}catch(t){m.error(f(t))}})()},[]),n.useEffect(()=>{if(o){const s=new Intl.DisplayNames(["en"],{type:"region"});j(s.of(o))}},[o]);const E={fullName:(a==null?void 0:a.fullName)||"",username:(a==null?void 0:a.username)||"",email:(a==null?void 0:a.email)||"",password:"",confirmPassword:"",phone:(a==null?void 0:a.phone)||"",countryName:(a==null?void 0:a.countryName)||"",roles:(a==null?void 0:a.roles)||"",status:(a==null?void 0:a.status)||""},I=V().shape({fullName:i().required("Full Name is required"),username:i().required("Username is required"),email:i().email().required("Email is required"),password:i().password().required("Password is required"),confirmPassword:i().oneOf([O("password"),null],"Passwords do not match").required("Confirm password is required"),phone:i().test("is-possible-phone","Please enter valid phone number",s=>Y(s)).test("is-valid-phone","Please enter valid phone number",s=>z(s)).required("Phone Number is required"),countryName:i().required("Country is required"),roles:$().min(1,"At least one role is required").required("Role is required"),status:i().oneOf(C,"Invalid status selected").required("Status is required")}),A=async(s,{setSubmitting:t})=>{var l;t(!0);try{const{data:r}=await h.patch(`/admin/admin-user/${d}`,{...s,countryName:b,countryCode:T(o)});r!=null&&r.success&&(m.success((r==null?void 0:r.message)||((l=r==null?void 0:r.data)==null?void 0:l.message)),q("/admin-users"))}catch(r){m.error(f(r))}finally{t(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"",children:e.jsx(M,{label:"Edit Admin User"})}),e.jsx("div",{className:"rounded-[20px] bg-white p-5",children:e.jsx(U,{initialValues:E,validationSchema:I,onSubmit:A,enableReinitialize:!0,children:s=>e.jsxs(D,{className:"flex flex-col gap-3",autoComplete:"off",children:[e.jsxs(u,{children:[e.jsx("div",{className:"w-full",children:e.jsx(x,{formik:s,name:"fullName",id:"fullName",label:"Full Name"})}),e.jsx("div",{className:"w-full",children:e.jsx(x,{formik:s,name:"username",id:"username",label:"Username"})})]}),e.jsxs(u,{children:[e.jsx("div",{className:"w-full",children:e.jsx(x,{formik:s,name:"email",id:"email",label:"Email"})}),e.jsx("div",{className:"w-full",children:e.jsx(L,{formik:s,name:"roles",id:"roles",label:"Role",options:P})})]}),e.jsxs(u,{children:[e.jsx("div",{className:"w-full",children:e.jsx(w,{formik:s,name:"password",id:"password",label:"Password"})}),e.jsx("div",{className:"w-full",children:e.jsx(w,{formik:s,name:"confirmPassword",id:"confirmPassword",label:"Confirm Password"})})]}),e.jsxs(u,{children:[e.jsx("div",{className:"w-full",children:e.jsx(G,{formik:s,name:"countryName",id:"countryName",label:"Country",getCountryCode:N})}),e.jsx("div",{className:"w-full",children:e.jsx(K,{name:"phone",id:"phone",label:"Phone",country:o})})]}),e.jsxs(u,{children:[e.jsx("div",{className:"w-full",children:e.jsx(X,{formik:s,name:"status",id:"status",label:"Status",options:y})}),e.jsx("div",{className:"w-full"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Q,{formik:s})})]})})})]})})}export{xe as default};
