import{G as $,k as R,r as o,V as c,h as j,j as e,m as B,A as g,u as _,g as H}from"./index-CtF5NqjV.js";import{h as S,T as V}from"./hasRequiredRole-osJ5szYF.js";import{B as D}from"./ButtonClipLoader-CrkQjnCO.js";import{N as T}from"./no-image-icon-Dam8WiVQ.js";import{I as k,a as C,N as P}from"./NoData-CRNyNY9D.js";import{S as E}from"./Status-CFvwze7x.js";import{f as K}from"./index-CTnICA7r.js";import{H as U}from"./HeadingPlusBackBtn-BgZ3OcMR.js";/* empty css                */import"./index-R1RIAz4U.js";import"./index-BygXZwzy.js";import"./BackButton-B3FMZxYv.js";function W(){var d,u,f;const{id:x}=$(),r=["fetch-in-review-lab-details",{id:x}],{isLoading:y,isError:h,data:p,error:m}=R({queryKey:r,queryFn:()=>g.get(`/lab/${x}`)}),l=(u=(d=p==null?void 0:p.data)==null?void 0:d.data)==null?void 0:u.doc;return o.useEffect(()=>{m&&c.error(j(m))},[p,m]),e.jsx(e.Fragment,{children:y?e.jsx(k,{}):h?e.jsx(C,{}):!l||((f=Object.keys(l))==null?void 0:f.length)===0?e.jsx(P,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsx("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:e.jsx("p",{className:"font-[600] text-[20px]",children:"Details"})}),e.jsxs("div",{className:"flex flex-col",children:[l!=null&&l.image?e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Logo"}),e.jsx("div",{className:"w-[100px] h-[100px] rounded-[10px] bg-[#f1f5f9]",children:e.jsx("a",{href:l!=null&&l.image?`${B}/${l==null?void 0:l.image}`:T,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:l!=null&&l.image?`${B}/${l==null?void 0:l.image}`:T,alt:"education logo",className:"inline-flex w-full h-full object-cover"})})})]}):"",e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Lab Name"}),e.jsx("p",{children:(l==null?void 0:l.title)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Phone"}),e.jsx("p",{children:l==null?void 0:l.phone})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Email"}),e.jsx("p",{children:l==null?void 0:l.email})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Country"}),e.jsx("p",{children:(l==null?void 0:l.countryName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"City"}),e.jsx("p",{children:(l==null?void 0:l.city)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4",children:[e.jsx("p",{children:"State/Province"}),e.jsx("p",{children:(l==null?void 0:l.province)||"N/A"})]})]})]})})})}function G(){var A,v;const{id:x}=$(),[r,y]=o.useState(!1),[h,p]=o.useState(!1),m=["fetch-in-review-lab-documents",{id:x,approving:r,declining:h}],{isLoading:l,data:d,isError:u,error:f}=R({queryKey:m,queryFn:()=>g.get(`/know-your-customer/?labObjectId=${x}`)}),t=(v=(A=d==null?void 0:d.data)==null?void 0:A.data)==null?void 0:v.docs;o.useEffect(()=>{f&&c.error(j(f))},[d,f]);const N=async s=>{var i;y(!0);try{const{data:a}=await g.patch(`/know-your-customer/approve/${s==null?void 0:s._id}`,{status:"Approved",statusChangeReason:"Verification Successful"});a!=null&&a.success&&c.success((a==null?void 0:a.message)||((i=a==null?void 0:a.data)==null?void 0:i.message))}catch(a){c.error(j(a))}finally{y(!1)}},w=async s=>{var i;p(!0);try{const{data:a}=await g.patch(`/know-your-customer/approve/${s==null?void 0:s._id}`,{status:"Declined",statusChangeReason:"Verification Failed"});a!=null&&a.success&&c.success((a==null?void 0:a.message)||((i=a==null?void 0:a.data)==null?void 0:i.message))}catch(a){c.error(j(a))}finally{p(!1)}};return e.jsx(e.Fragment,{children:l?e.jsx(k,{}):u?e.jsx(C,{}):!t||(t==null?void 0:t.length)===0?e.jsx(P,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:t==null?void 0:t.map((s,i)=>e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsxs("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{className:"font-[600] text-[20px]",children:"Document"}),(s==null?void 0:s.status)==="In Review"||(s==null?void 0:s.status)==="Pending"?e.jsxs("div",{className:"flex max-[370px]:flex-col max-[370px]:w-full max-[370px]:items-start items-center gap-4",children:[e.jsx("div",{className:"max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center gap-1 bg-fullGreen w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>N(s),disabled:r,children:r?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(D,{}),"Please Wait"]}):"Approve"})}),e.jsx("div",{className:" max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"bg-fullRed w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>w(s),disabled:h,children:h?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(D,{}),"Please Wait"]}):"Decline"})})]}):""]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Identification Type"}),e.jsx("p",{children:(s==null?void 0:s.identificationDocumentType)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Business Name"}),e.jsx("p",{children:(s==null?void 0:s.businessName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Lab License"}),e.jsx("p",{children:(s==null?void 0:s.businessLicense)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Business Address"}),e.jsx("p",{children:(s==null?void 0:s.businessAddress)||"N/A"})]}),s!=null&&s.businessIdentificationDocument?e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Business Identification Document"}),e.jsx("div",{className:"w-[100px] h-[100px] rounded-[10px] bg-[#f1f5f9]",children:e.jsx("a",{href:`${B}/${s==null?void 0:s.businessIdentificationDocument}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:`${B}/${s==null?void 0:s.businessIdentificationDocument}`,alt:"education logo",className:"inline-flex w-full h-full object-cover"})})})]}):"",e.jsxs("div",{className:"flex items-center gap-3 justify-between px-5 py-4",children:[e.jsx("p",{children:"Status"}),e.jsx("p",{children:e.jsx(E,{status:s==null?void 0:s.status})})]})]})]},i))})})}function O(){var A,v;const{id:x}=$(),[r,y]=o.useState(!1),[h,p]=o.useState(!1),m=["fetch-in-review-lab-services",{id:x,approving:r,declining:h}],{isLoading:l,isError:d,data:u,error:f}=R({queryKey:m,queryFn:()=>g.get(`/offered-lab-test?labHeadOffice=${x}`)}),t=(v=(A=u==null?void 0:u.data)==null?void 0:A.data)==null?void 0:v.docs;o.useEffect(()=>{f&&c.error(j(f))},[u,f]);const N=async s=>{var i;y(!0);try{const{data:a}=await g.patch(`/offered-lab-test/approve/${s==null?void 0:s._id}`,{status:"Approved",statusChangeReason:"Passed All Tests"});a!=null&&a.success&&c.success((a==null?void 0:a.message)||((i=a==null?void 0:a.data)==null?void 0:i.message))}catch(a){c.error(j(a))}finally{y(!1)}},w=async s=>{var i;p(!0);try{const{data:a}=await g.patch(`/offered-lab-test/approve/${s==null?void 0:s._id}`,{status:"Declined",statusChangeReason:"Failed All Tests"});a!=null&&a.success&&c.success((a==null?void 0:a.message)||((i=a==null?void 0:a.data)==null?void 0:i.message))}catch(a){c.error(j(a))}finally{p(!1)}};return e.jsx(e.Fragment,{children:l?e.jsx(k,{}):d?e.jsx(C,{}):!t||(t==null?void 0:t.length)===0?e.jsx(P,{goBackButton:!1}):e.jsx("div",{className:"rounded-[20px] flex flex-col gap-5",children:t==null?void 0:t.map((s,i)=>{var a;return e.jsxs("div",{className:"bg-white rounded-[20px]",children:[e.jsxs("div",{className:"flex max-[500px]:flex-col max-[500px]:items-start max-[500px]:gap-3 items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{className:"font-[600] text-[20px]",children:"Lab Test"}),(s==null?void 0:s.status)==="In Review"||(s==null?void 0:s.status)==="Pending"?e.jsxs("div",{className:"flex max-[370px]:flex-col max-[370px]:w-full max-[370px]:items-start items-center gap-4",children:[e.jsx("div",{className:"max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"inline-flex items-center justify-center gap-1 bg-fullGreen w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>N(s),disabled:r,children:r?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(D,{}),"Please Wait"]}):"Approve"})}),e.jsx("div",{className:"max-[370px]:w-full",children:e.jsx("button",{type:"button",className:"bg-fullRed w-[140px] max-[370px]:w-full h-[40px] rounded-[8px] cursor-pointer text-white",onClick:()=>w(s),disabled:h,children:h?e.jsxs("span",{className:"inline-flex items-center gap-1 justify-center",children:[e.jsx(D,{}),"Please Wait"]}):"Decline"})})]}):""]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Test Name"}),e.jsx("p",{children:(s==null?void 0:s.title)||((a=s==null?void 0:s.labTest)==null?void 0:a.title)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1 justify-between px-5 py-4 border-b border-lightBlue",children:[e.jsx("p",{children:"Price"}),e.jsxs("p",{children:[e.jsx("span",{children:(s==null?void 0:s.currencyCode)==="USD"?"$":""}),e.jsx("span",{children:s!=null&&s.price?parseFloat(s==null?void 0:s.price).toFixed(2):"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-between px-5 py-4",children:[e.jsx("p",{children:"Status"}),e.jsx("p",{children:e.jsx(E,{status:s==null?void 0:s.status})})]})]})]},i)})})})}const q=[{id:1,name:"Lab Tests",requiredRoles:["admin"]},{id:2,name:"Personal Details",requiredRoles:["admin"]},{id:3,name:"Documents",requiredRoles:["admin"]}];function ne(){var I,L;const{id:x}=$(),[r,y]=o.useState({}),[h,p]=o.useState(!1),[m,l]=o.useState(!1),d=_(),u=H(),f=u==null?void 0:u.roles,t=o.useMemo(()=>f,[]),[N,w]=o.useState(1),A=["fetch-in-review-lab-profile-data",{id:x}],{data:v,error:s}=R({queryKey:A,queryFn:()=>g.get(`/lab/${x}`)});o.useEffect(()=>{if(v){const{data:{data:{doc:b}}}=v;y(b)}s&&c.error(j(s))},[v,s]),o.useEffect(()=>{const b=q.find(n=>S(n.requiredRoles,t));b?w(b.id):(c.error("User has no access to any tabs"),w(null))},[t]);const i={profileName:(r==null?void 0:r.title)||(r==null?void 0:r.fullName)||((I=r==null?void 0:r.user)==null?void 0:I.username)||e.jsxs("span",{children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]})||"N/A",profileImage:(r==null?void 0:r.image)||((L=r==null?void 0:r.user)==null?void 0:L.image),phone:K(r==null?void 0:r.phone)||"N/A",email:(r==null?void 0:r.email)||"N/A",country:(r==null?void 0:r.countryName)||"N/A",state:(r==null?void 0:r.province)||"N/A",city:(r==null?void 0:r.city)||"N/A",address:(r==null?void 0:r.address)||"",status:(r==null?void 0:r.status)||""},a=async()=>{var b;p(!0);try{const{data:n}=await g.patch(`/lab/approve/${x}`,{status:"Approved",statusChangeReason:"Passed all tests."});n!=null&&n.success&&(c.success((n==null?void 0:n.message)||((b=n==null?void 0:n.data)==null?void 0:b.message)),d(`/labs/approved/profile/${x}`))}catch(n){c.error(j(n))}finally{p(!1)}},F=async()=>{var b;l(!0);try{const{data:n}=await g.patch(`/lab/approve/${x}`,{status:"Declined",statusChangeReason:"Failed all tests."});n!=null&&n.success&&(c.success((n==null?void 0:n.message)||((b=n==null?void 0:n.data)==null?void 0:b.message)),d(`/labs/declined/profile/${x}`))}catch(n){c.error(j(n))}finally{l(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{className:"",children:e.jsx(U,{label:"Lab Profile"})}),N!==null&&e.jsx(V,{activeTab:N,setActiveTab:w,roles:t,hasRequiredRole:S,tabs:q,profileData:i,button1Label:"Approve",button1Handler:a,submitting1:h,button2Label:"Decline",button2Handler:F,submitting2:m}),e.jsxs("div",{className:"",children:[N===1?e.jsx(O,{}):"",N===2?e.jsx(W,{}):"",N===3?e.jsx(G,{}):""]})]})})}export{ne as default};
