import{D as x,r as d,k as R,c as b,a as l,l as L,j as e,F as j,b as g,m as P,q as m,S as N,A as V,p as O,P as p,V as v,h as S,Y as U,y as z,H as Y}from"./index-B1B7tQkZ.js";import{H}from"./HeadingPlusBackBtn-Zi4RwdaY.js";import{h as T}from"./moment-C5S46NFB.js";import{i as M,a as K}from"./index-RYfX4fpc.js";import{g as Q}from"./index-CoazGQ7O.js";import{L as _}from"./apiEndpoints-BwAEE1pY.js";import{S as k}from"./SingleImageUpload-C7Bzu1LU.js";import{I as f}from"./Input-q6AVNVZf.js";import{P as G}from"./PhoneInput-BeevYskT.js";import{C as J}from"./CountrySearchInput-b0VJu5dg.js";import{S as W,C as X}from"./CitySearchInput-DZtNTNEC.js";import"./BackButton-CHZgTKcg.js";import"./index-BlONpDat.js";import"./index-NkVyEFcp.js";import"./no-image-icon-CabPHXKl.js";function Z(){const{id:r}=x(),[i,n]=d.useState(""),[o,t]=d.useState(""),[c,w]=d.useState(""),[y,C]=d.useState("");d.useEffect(()=>{if(i){const a=new Intl.DisplayNames(["en"],{type:"region"});t(a.of(i))}},[i]);const I=async()=>r?(await V.get(`${_}/${r}`)).data.data.doc:null,{data:s,isLoading:q,isError:F,error:B}=R({queryKey:["lab",r],queryFn:I,enabled:!!r,staleTime:5*60*1e3,cacheTime:30*60*1e3});d.useEffect(()=>{s&&(n(Q(s==null?void 0:s.countryCode)||(s==null?void 0:s.countryCode)||""),w((s==null?void 0:s.province)||""))},[s]);const A=()=>{var a;return{imageDataURI:null,fullName:(s==null?void 0:s.fullName)||((a=s==null?void 0:s.user)==null?void 0:a.username)||"",email:(s==null?void 0:s.email)||"",countryName:(s==null?void 0:s.countryName)||"",province:(s==null?void 0:s.province)||"",city:(s==null?void 0:s.city)||"",phone:(s==null?void 0:s.phone)||""}},E=b().shape({imageDataURI:L().nullable().test("fileSize","Image size must be less than 4MB",a=>a===null||a instanceof File&&a.size<=4*1024*1024).test("fileFormat","Accepted formats are jpg, png",a=>a===null||a instanceof File&&["image/jpeg","image/png"].includes(a.type)).required("Image is required"),fullName:l().required("Full Name is required"),email:l().email("Please enter valid email").required("Email is required"),countryName:l().required("Country Name is required"),province:l().optional(),city:l().optional(),phone:l().test("is-possible-phone","Please enter valid phone number",a=>a?M(a):!0).test("is-valid-phone","Please enter valid phone number",a=>a?K(a):!0).required("Phone is required")}),D=async a=>{const{fullName:u,email:h,phone:ae,...$}=a;console.log({...$,imageDataURI:y,dateOfBirth:T(a==null?void 0:a.dateOfBirth).format("YYYY-MM-DD"),countryCode:i,doctorId:r})};return q?e.jsx("div",{className:"flex justify-center items-center h-64 text-darkBlue",children:"Loading profile data..."}):F?e.jsxs("div",{className:"flex justify-center items-center h-64 text-red-500",children:["Error loading profile: ",B.message]}):s?e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(j,{initialValues:A(),validationSchema:E,onSubmit:D,enableReinitialize:!0,children:a=>{var u,h;return e.jsxs(g,{className:"flex flex-col gap-3 p-5 bg-white rounded-[20px] border border-lightBlue shadow",autoComplete:"off",children:[e.jsx("p",{className:"text-xl text-darkBlue font-[500] border-b border-b-lightBlue pb-2",children:"Profile Settings"}),e.jsx("div",{className:"",children:e.jsx(k,{formik:a,name:"imageDataURI",id:"imageDataURI",label:"Profile Image",base64Image:y,setBase64Image:C,backendImage:(u=s==null?void 0:s.user)!=null&&u.image?`${P}/${(h=s==null?void 0:s.user)==null?void 0:h.image}`:s!=null&&s.image?`${P}/${s==null?void 0:s.image}`:""})}),e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(f,{formik:a,name:"fullName",id:"fullName",label:"Full Name",disabled:!0,hintOn:!0,hintText:"Name can't be edited"})}),e.jsx("div",{className:"w-full",children:e.jsx(f,{formik:a,name:"email",id:"email",label:"Email",disabled:!0,hintOn:!0,hintText:"Email can't be edited"})})]}),e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(G,{name:"phone",id:"phone",label:"Phone",country:i,disabled:!0,hintOn:!0,hintText:"Phone can't be edited"})}),e.jsx("div",{className:"w-full",children:e.jsx(J,{formik:a,name:"countryName",id:"countryName",label:"Country",getCountryCode:n})})]}),e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(W,{formik:a,name:"province",id:"province",label:"State/Province",countryName:o,getStateName:w})}),e.jsx("div",{className:"w-full",children:e.jsx(X,{formik:a,name:"city",id:"city",label:"City",countryName:o,stateName:c})})]}),e.jsx("div",{className:"mt-2",children:e.jsx(N,{formik:a})})]})}})})}):e.jsx("div",{className:"flex justify-center items-center h-64 text-gray-500",children:"No profile data found for this ID."})}U(z);function ee(){const{id:r}=x(),i={password:"",newPassword:"",confirmPassword:""},n=b().shape({password:l().required("Current Password is required"),newPassword:l().password().required("New Password is required"),confirmPassword:l().oneOf([O("newPassword"),null],"Passwords do not match").required("Confirm password is required")}),o=async t=>{try{console.log({...t,doctorId:r})}catch(c){v.error(S(c))}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(j,{initialValues:i,validationSchema:n,onSubmit:o,enableReinitialize:!0,children:t=>e.jsxs(g,{className:"flex flex-col gap-3 p-5 bg-white rounded-[20px] border border-lightBlue shadow",children:[e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(p,{formik:t,name:"password",id:"password",label:"Current Password"})}),e.jsx("div",{className:"w-full",children:e.jsx(p,{formik:t,name:"newPassword",id:"newPassword",label:"New Password"})})]}),e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(p,{formik:t,name:"confirmPassword",id:"confirmPassword",label:"Confirm Password"})}),e.jsx("div",{className:"w-full"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(N,{formik:t})})]})})})})}function se(){const{id:r}=x(),i={adminProfit:""},n=b().shape({adminProfit:Y().typeError("Admin Profit must be a number").positive("Admin Profit must be a positive number").min(0,"Admin Profit cannot be less than 0").max(100,"Admin Profit cannot be more than 100").required("Admin Profit is required")}),o=async t=>{try{console.log({...t,doctorId:r})}catch(c){v.error(S(c))}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(j,{initialValues:i,validationSchema:n,onSubmit:o,enableReinitialize:!0,children:t=>e.jsxs(g,{className:"flex flex-col gap-3 p-5 bg-white rounded-[20px] border border-lightBlue shadow",children:[e.jsxs(m,{children:[e.jsx("div",{className:"w-full",children:e.jsx(f,{formik:t,name:"adminProfit",id:"adminProfit",label:"Admin Profit %"})}),e.jsx("div",{className:"w-full"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(N,{formik:t})})]})})})})}function je(){const[r,i]=d.useState("profile"),n=o=>`cursor-pointer px-4 py-2 rounded-md transition-colors max-[500px]:w-full ${r===o?"bg-myBlue text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{className:"",children:e.jsx(H,{label:"Edit Lab"})}),e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col ",children:[e.jsx("button",{type:"button",className:n("profile"),onClick:()=>i("profile"),children:"Profile"}),e.jsx("button",{type:"button",className:n("password"),onClick:()=>i("password"),children:"Change Password"}),e.jsx("button",{type:"button",className:n("admin-profit"),onClick:()=>i("admin-profit"),children:"Set Admin Profit"})]}),e.jsx("div",{children:r==="profile"?e.jsx(Z,{}):r==="password"?e.jsx(ee,{}):e.jsx(se,{})})]})})}export{je as default};
