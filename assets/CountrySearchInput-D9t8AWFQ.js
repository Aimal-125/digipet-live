import{r as o,j as u,E as F}from"./index-BpncqqTg.js";const N=({formik:s,name:n,id:C,label:m,getCountryCode:v=()=>{}})=>{const[S,h]=o.useState(""),[i,b]=o.useState([]),[c,f]=o.useState([]),[y,r]=o.useState(!1),[a,l]=o.useState(-1),p=o.useRef(null),d=o.useRef(null);o.useEffect(()=>{(async()=>{try{const t=await fetch("https://restcountries.com/v3.1/all");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const w=(await t.json()).map(x=>({name:x.name.common,cca2:x.cca2,cca3:x.cca3}));b(w)}catch(t){console.error("Error fetching countries:",t)}})()},[]),o.useEffect(()=>{const e=s.values[n];e&&typeof e=="string"&&e.name?h(e.name):e||h("")},[s.values,n]);const j=e=>{const t=e.target.value;if(h(t),l(-1),t.length>0){const g=i.filter(w=>w.name.toLowerCase().includes(t.toLowerCase()));f(g),r(!0)}else f([]),r(!1)},E=e=>{h(e.name),console.log("Selected Country:",e),v(e.cca2),s.setFieldValue(n,e.name),f([]),r(!1),l(-1),s.setFieldTouched(n,!0)},D=e=>{y&&(e.key==="ArrowUp"?(e.preventDefault(),l(t=>t<=0?c.length-1:t-1)):e.key==="ArrowDown"?(e.preventDefault(),l(t=>t===c.length-1?0:t+1)):e.key==="Enter"?(e.preventDefault(),a>=0&&a<c.length&&E(c[a])):e.key==="Escape"&&(r(!1),l(-1),s.setFieldTouched(n,!0)))};return o.useEffect(()=>{const e=t=>{p.current&&!p.current.contains(t.target)&&d.current&&!d.current.contains(t.target)&&(r(!1),l(-1),s.setFieldTouched(n,!0))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s,n]),o.useEffect(()=>{if(a!==-1&&d.current){const e=d.current.children[a];e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}},[a]),u.jsxs("div",{className:"relative flex flex-col gap-3",children:[m&&u.jsx("label",{htmlFor:C,className:"block text-[18px] font-[500] text-[#252C62]",children:m}),u.jsx("input",{ref:p,type:"text",id:C,name:n,value:s==null?void 0:s.values[n],onChange:e=>{s.handleChange(e),j(e)},onKeyDown:D,onFocus:()=>{if(S.length>0&&i.length>0){const e=i.filter(t=>t.name.toLowerCase().includes(S.toLowerCase()));f(e),r(!0)}else i.length>0&&(f(i),r(!0))},onBlur:e=>{s.handleBlur(e),setTimeout(()=>{r(!1),l(-1)},100)},placeholder:"Search for a country...",className:"border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full"}),y&&c.length>0&&u.jsx("ul",{ref:d,className:"absolute left-0 top-[100%] z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto shadow-lg",children:c.map((e,t)=>u.jsxs("li",{className:`px-4 py-2 cursor-pointer ${t===a?"bg-blue-100":"hover:bg-gray-100"}`,onClick:()=>E(e),onMouseDown:g=>g.preventDefault(),children:[e.name," "]},e.cca2||t))}),u.jsx(F,{name:n,component:"div",className:"text-red-500 text-sm mt-1"})]})};export{N as C};
