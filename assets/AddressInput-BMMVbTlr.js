import{g as X,r as a,R as L,j as y}from"./index-CI0tfhfL.js";import{r as Z}from"./index-BZuboyw-.js";import{E as ee}from"./index.esm-D3n2j42x.js";import{I as te}from"./index-C1-o15lp.js";var G,U;function ne(){return U||(U=1,G=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,r,s;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),o=s.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=o;r--!==0;){var l=s[r];if(!t(e[l],n[l]))return!1}return!0}return e!==e&&n!==n}),G}var oe=ne();const re=X(oe);function I(){return I=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},I.apply(null,arguments)}function D(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.indexOf(o)!==-1)continue;n[o]=t[o]}return n}function se(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ae(t){var e=se(t,"string");return typeof e=="symbol"?e:e+""}const P={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},ie="https://maps.googleapis.com/maps/api/js";class N{static async load(e,n){var o;const r=e.libraries?e.libraries.split(","):[],s=this.serializeParams(e);this.listeners.push(n),(o=window.google)!=null&&(o=o.maps)!=null&&o.importLibrary?(this.serializedApiParams||(this.loadingStatus=P.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=s,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==s&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const l=["maps",...r];await Promise.all(l.map(i=>google.maps.importLibrary(i)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const o=()=>n||(n=new Promise((r,s)=>{var l;const i=document.createElement("script"),u=new URLSearchParams;for(const[f,d]of Object.entries(e)){const p=f.replace(/[A-Z]/g,g=>"_"+g[0].toLowerCase());u.set(p,String(d))}u.set("loading","async"),u.set("callback","__googleMapsCallback__"),i.async=!0,i.src=ie+"?"+u.toString(),i.nonce=((l=document.querySelector("script[nonce]"))==null?void 0:l.nonce)||"",i.onerror=()=>{this.loadingStatus=P.FAILED,this.notifyLoadingStatusListeners(),s(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=P.LOADED,this.notifyLoadingStatusListeners(),r()},window.gm_authFailure=()=>{this.loadingStatus=P.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=P.LOADING,this.notifyLoadingStatusListeners(),document.head.append(i)}),n);google.maps.importLibrary=r=>o().then(()=>google.maps.importLibrary(r))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}N.loadingStatus=P.NOT_LOADED;N.serializedApiParams=void 0;N.listeners=[];const le=["onLoad","onError","apiKey","version","libraries"],ce=["children"],ue="GMP_visgl_rgmlibrary_v1_default",T=L.createContext(null);function de(){const[t,e]=a.useState({});return{mapInstances:t,addMapInstance:(s,l="default")=>{e(i=>I({},i,{[l]:s}))},removeMapInstance:(s="default")=>{e(l=>D(l,[s].map(ae)))},clearMapInstances:()=>{e({})}}}function fe(t){const{onLoad:e,onError:n,apiKey:o,version:r,libraries:s=[]}=t,l=D(t,le),[i,u]=a.useState(N.loadingStatus),[f,d]=a.useReducer((c,E)=>c[E.name]?c:I({},c,{[E.name]:E.value}),{}),p=a.useMemo(()=>s==null?void 0:s.join(","),[s]),g=a.useMemo(()=>JSON.stringify(I({apiKey:o,version:r},l)),[o,r,l]),h=a.useCallback(async c=>{var E;if(f[c])return f[c];if(!((E=google)!=null&&(E=E.maps)!=null&&E.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const M=await window.google.maps.importLibrary(c);return d({name:c,value:M}),M},[f]);return a.useEffect(()=>{(async()=>{try{const c=I({key:o},l);r&&(c.v=r),(p==null?void 0:p.length)>0&&(c.libraries=p),(c.channel===void 0||c.channel<0||c.channel>999)&&delete c.channel,c.solutionChannel===void 0?c.solutionChannel=ue:c.solutionChannel===""&&delete c.solutionChannel,await N.load(c,E=>u(E));for(const E of["core","maps",...s])await h(E);e&&e()}catch(c){n?n(c):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",c)}})()},[o,p,g]),{status:i,loadedLibraries:f,importLibrary:h}}const ge=t=>{const{children:e}=t,n=D(t,ce),{mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:l}=de(),{status:i,loadedLibraries:u,importLibrary:f}=fe(n),d=a.useMemo(()=>({mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:l,status:i,loadedLibraries:u,importLibrary:f}),[o,r,s,l,i,u,f]);return L.createElement(T.Provider,{value:d},e)};function me(t,e){for(const n of ye){const o=e[n],r=q[n];a.useEffect(()=>{if(!t||!o)return;const s=google.maps.event.addListener(t,r,l=>{o(pe(r,t,l))});return()=>s.remove()},[t,r,o])}}function pe(t,e,n){const o={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(he.includes(t)){const s=o,l=e.getCenter(),i=e.getZoom(),u=e.getHeading()||0,f=e.getTilt()||0,d=e.getBounds();return(!l||!d||!Number.isFinite(i))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),s.detail={center:(l==null?void 0:l.toJSON())||{lat:0,lng:0},zoom:i||0,heading:u,tilt:f,bounds:(d==null?void 0:d.toJSON())||{north:90,east:180,south:-90,west:-180}},s}else if(ve.includes(t)){var r;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const s=o;return s.domEvent=n.domEvent,s.stoppable=!0,s.stop=()=>n.stop(),s.detail={latLng:((r=n.latLng)==null?void 0:r.toJSON())||null,placeId:n.placeId},s}return o}const q={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},he=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],ve=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],ye=Object.keys(q);function Ee(t,e){const n=a.useRef(void 0);(!n.current||!re(e,n.current))&&(n.current=e),a.useEffect(t,n.current)}const be=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function Ce(t,e){const n={},o=Object.keys(e);for(const r of o)be.has(r)&&(n[r]=e[r]);Ee(()=>{t&&t.setOptions(n)},[n])}function J(){var t;return((t=a.useContext(T))==null?void 0:t.status)||P.NOT_LOADED}function Le(t,e){const{viewport:n,viewState:o}=e,r=!!n;return a.useLayoutEffect(()=>{if(!t||!o)return;const{latitude:s,longitude:l,bearing:i,pitch:u,zoom:f}=o;t.moveCamera({center:{lat:s,lng:l},heading:i,tilt:u,zoom:f+1})},[t,o]),r}function xe(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function V(t){return xe(t)?t:t.toJSON()}function Me(t,e,n){const o=n.center?V(n.center):null;let r=null,s=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(r=o.lat,s=o.lng);const l=Number.isFinite(n.zoom)?n.zoom:null,i=Number.isFinite(n.heading)?n.heading:null,u=Number.isFinite(n.tilt)?n.tilt:null;a.useLayoutEffect(()=>{if(!t)return;const f={};let d=!1;r!==null&&s!==null&&(e.current.center.lat!==r||e.current.center.lng!==s)&&(f.center={lat:r,lng:s},d=!0),l!==null&&e.current.zoom!==l&&(f.zoom=l,d=!0),i!==null&&e.current.heading!==i&&(f.heading=i,d=!0),u!==null&&e.current.tilt!==u&&(f.tilt=u,d=!0),d&&t.moveCamera(f)})}const we=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return L.createElement("div",{style:t},L.createElement("h2",null,"Error: AuthFailure"),L.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",L.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function Se(){const[t,e]=a.useState(null),n=a.useCallback(o=>e(o),[e]);return[t,n]}function K(){return J()===P.LOADED}function Ae(){const[,t]=a.useReducer(e=>e+1,0);return t}function Oe(t,e){const n=t.getCenter(),o=t.getZoom(),r=t.getHeading()||0,s=t.getTilt()||0,l=t.getBounds();(!n||!l||!Number.isFinite(o))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:(n==null?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:r,tilt:s})}function ke(t){const e=Ae(),n=a.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return a.useEffect(()=>{if(!t)return;const o=google.maps.event.addListener(t,"bounds_changed",()=>{Oe(t,n),e()});return()=>o.remove()},[t,e]),n}const Ie=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],Pe=["padding"];class F{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}F.entries={};function _e(t,e){const n=K(),[o,r]=a.useState(null),[s,l]=Se(),i=ke(o),{id:u,defaultBounds:f,defaultCenter:d,defaultZoom:p,defaultHeading:g,defaultTilt:h,reuseMaps:c,renderingType:E,colorScheme:M}=t,v=D(t,Ie),A=t.zoom!==void 0||t.defaultZoom!==void 0,O=t.center!==void 0||t.defaultCenter!==void 0;!f&&(!A||!O)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!v.center&&d&&(v.center=d),!v.zoom&&Number.isFinite(p)&&(v.zoom=p),!v.heading&&Number.isFinite(g)&&(v.heading=g),!v.tilt&&Number.isFinite(h)&&(v.tilt=h);for(const w of Object.keys(v))v[w]===void 0&&delete v[w];const k=a.useRef(void 0);return a.useEffect(()=>{if(!s||!n)return;const{addMapInstance:w,removeMapInstance:S}=e,{mapId:m}=t,b=`${m||"default"}:${E||"default"}:${M||"LIGHT"}`;let x,C;if(c&&F.has(b)?(C=F.pop(b),x=C.getDiv(),s.appendChild(x),C.setOptions(v),setTimeout(()=>C.setCenter(C.getCenter()),0)):(x=document.createElement("div"),x.style.height="100%",s.appendChild(x),C=new google.maps.Map(x,I({},v,E?{renderingType:E}:{},M?{colorScheme:M}:{}))),r(C),w(C,u),f){const{padding:_}=f,B=D(f,Pe);C.fitBounds(B,_)}else(!A||!O)&&C.fitBounds({east:180,west:-180,south:-90,north:90});if(k.current){const{mapId:_,cameraState:B}=k.current;_!==m&&C.setOptions(B)}return()=>{k.current={mapId:m,cameraState:i.current},x.remove(),c?F.push(b,C):google.maps.event.clearInstanceListeners(C),r(null),S(u)}},[s,n,u,t.mapId,t.renderingType,t.colorScheme]),[o,l,i]}const W=L.createContext(null),Y=t=>{const{children:e,id:n,className:o,style:r}=t,s=a.useContext(T),l=J();if(!s)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[i,u,f]=_e(t,s);Me(i,f,t),me(i,t),Ce(i,t);const d=Le(i,t),p=!!t.controlled;a.useEffect(()=>{if(i)return d&&i.setOptions({disableDefaultUI:!0}),(d||p)&&i.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{i.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[i,d,p,t.gestureHandling,t.keyboardShortcuts]);const g=t.center?V(t.center):null;let h=null,c=null;g&&Number.isFinite(g.lat)&&Number.isFinite(g.lng)&&(h=g.lat,c=g.lng);const E=a.useMemo(()=>{var A,O,k,w,S;return{center:{lat:(A=h)!=null?A:0,lng:(O=c)!=null?O:0},zoom:(k=t.zoom)!=null?k:0,heading:(w=t.heading)!=null?w:0,tilt:(S=t.tilt)!=null?S:0}},[h,c,t.zoom,t.heading,t.tilt]);a.useLayoutEffect(()=>{if(!i||!p)return;i.moveCamera(E);const A=i.addListener("bounds_changed",()=>{i.moveCamera(E)});return()=>A.remove()},[i,p,E]);const M=a.useMemo(()=>I({width:"100%",height:"100%",position:"relative",zIndex:d?-1:0},r),[r,d]),v=a.useMemo(()=>({map:i}),[i]);return l===P.AUTH_FAILURE?L.createElement("div",{style:I({position:"relative"},o?{}:M),className:o},L.createElement(we,null)):L.createElement("div",I({ref:u,"data-testid":"map",style:o?void 0:M,className:o},n?{id:n}:{}),i?L.createElement(W.Provider,{value:v},e):null)};Y.deckGLViewProps=!0;const H=new Set;function De(...t){const e=JSON.stringify(t);H.has(e)||(H.add(e),console.error(...t))}const R=(t=null)=>{const e=a.useContext(T),{map:n}=a.useContext(W)||{};if(e===null)return De("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=e;return t!==null?o[t]||null:n||o.default||null};function Q(t){const e=K(),n=a.useContext(T);return a.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),(n==null?void 0:n.loadedLibraries[t])||null}function j(t,e,n){a.useEffect(()=>{if(!t||!e||!n)return;const o=google.maps.event.addListener(t,e,n);return()=>o.remove()},[t,e,n])}function z(t,e,n){a.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function $(t,e,n){a.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function Ne(t){return t.nodeType===Node.ELEMENT_NODE}const Te=L.createContext(null),je={BOTTOM:["50%","100%"]},ze=({children:t,styles:e,className:n,anchorPoint:o})=>{const[r,s]=o??je.BOTTOM;let l=`-${r}`,i=`-${s}`;r.trimStart().startsWith("-")&&(l=r.substring(1)),s.trimStart().startsWith("-")&&(i=s.substring(1));const u=`translate(50%, 100%) translate(${l}, ${i})`;return L.createElement("div",{style:{transform:u}},L.createElement("div",{className:n,style:e},t))};function Fe(t){const[e,n]=a.useState(null),[o,r]=a.useState(null),s=R(),l=Q("marker"),{children:i,onClick:u,className:f,onMouseEnter:d,onMouseLeave:p,onDrag:g,onDragStart:h,onDragEnd:c,collisionBehavior:E,clickable:M,draggable:v,position:A,title:O,zIndex:k}=t,w=a.Children.count(i);return a.useEffect(()=>{if(!s||!l)return;const S=new l.AdvancedMarkerElement;S.map=s,n(S);let m=null;return w>0&&(m=document.createElement("div"),m.isCustomMarker=!0,S.content=m,r(m)),()=>{var b;S.map=null,(b=m)==null||b.remove(),n(null),r(null)}},[s,l,w]),a.useEffect(()=>{!e||!e.content||w>0||(e.content.className=f||"")},[e,f,w]),z(e,"position",A),z(e,"title",O??""),z(e,"zIndex",k),z(e,"collisionBehavior",E),a.useEffect(()=>{e&&(v!==void 0?e.gmpDraggable=v:g||h||c?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,v,g,c,h]),a.useEffect(()=>{if(!e)return;const S=M!==void 0||!!u||!!d||!!p;e.gmpClickable=S,S&&e!=null&&e.content&&Ne(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,M,u,d,p]),j(e,"click",u),j(e,"drag",g),j(e,"dragstart",h),j(e,"dragend",c),$(e==null?void 0:e.element,"mouseenter",d),$(e==null?void 0:e.element,"mouseleave",p),[e,o]}const Re=a.forwardRef((t,e)=>{const{children:n,style:o,className:r,anchorPoint:s}=t,[l,i]=Fe(t),u=a.useMemo(()=>l?{marker:l}:null,[l]);return a.useImperativeHandle(e,()=>l,[l]),i?L.createElement(Te.Provider,{value:u},Z.createPortal(L.createElement(ze,{anchorPoint:s,styles:o,className:r},n),i)):null});function Be(){const[t,e]=a.useState(null);return[a.useCallback(o=>{e(o)},[]),t]}const Ge={LEFT_TOP:5},Ue=({children:t,position:e})=>{const n=a.useMemo(()=>document.createElement("div"),[]),o=R();return a.useEffect(()=>{if(!o)return;const r=o.controls[e];return r.push(n),()=>{const s=r.getArray();if(!s)return;const l=s.indexOf(n);r.removeAt(l)}},[n,o,e]),Z.createPortal(t,n)},He=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function $e(t){const[e,n]=a.useState(null),o=R(),{onClick:r,onDrag:s,onDragStart:l,onDragEnd:i,onMouseOver:u,onMouseOut:f}=t,d=D(t,He),{position:p,draggable:g}=d;return a.useEffect(()=>{if(!o){o===void 0&&console.error("<Marker> has to be inside a Map component.");return}const h=new google.maps.Marker(d);return h.setMap(o),n(h),()=>{h.setMap(null),n(null)}},[o]),a.useEffect(()=>{if(!e)return;const h=e,c=google.maps.event;return r&&c.addListener(h,"click",r),s&&c.addListener(h,"drag",s),l&&c.addListener(h,"dragstart",l),i&&c.addListener(h,"dragend",i),u&&c.addListener(h,"mouseover",u),f&&c.addListener(h,"mouseout",f),e.setDraggable(!!g),()=>{c.clearInstanceListeners(h)}},[e,g,r,s,l,i,u,f]),a.useEffect(()=>{e&&d&&e.setOptions(d)},[e,d]),a.useEffect(()=>{g||!p||!e||e.setPosition(p)},[g,p,e]),e}a.forwardRef((t,e)=>{const n=$e(t);return a.useImperativeHandle(e,()=>n,[n]),L.createElement(L.Fragment,null)});function Ye({formik:t,label:e="Address"}){const[n,o]=a.useState(!1),[r,s]=a.useState(null),[l,i]=a.useState(null),[u,f]=a.useState(!1),[d,p]=a.useState(!1),[g,h]=a.useState(null),[c,E]=Be(),M="AIzaSyDIBfIEiwZqaEBV1N2DbCogGhHLfsyhR6c",v={lat:40.7128,lng:-74.006},A=()=>new Promise(m=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(b=>{const x={lat:b.coords.latitude,lng:b.coords.longitude};s(x),i(x),m(x)},b=>{console.error("Geolocation error:",b),s(v),i(v),alert("Could not retrieve your location. Using a default location."),m(v)}):(s(v),i(v),alert("Geolocation is not supported by your browser. Using a default location."),m(v))}),O=async(m,b)=>{if(!m||!b)return console.error("Invalid coordinates for geocoding"),"Could not determine address";p(!0);try{const x=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${m},${b}&key=${M}`);if(!x.ok)throw new Error(`Geocoding API request failed: ${x.statusText}`);const C=await x.json();if(C.status==="OK"&&C.results&&C.results.length>0){const _=C.results[0].formatted_address;return console.log("Geocoding result:",_),p(!1),_}else return console.error("Geocoding failed:",C.status,C.error_message),p(!1),`Address not found (${C.status})`}catch(x){return console.error("Error during geocoding fetch:",x),p(!1),"Geocoding request failed"}},k=m=>{m.target.classList.contains("address-input-modal")&&o(!1)},w=a.useCallback(m=>{if(m.latLng){const b={lat:m.latLng.lat(),lng:m.latLng.lng()};console.log("Marker dragged to:",b),s(b)}},[]),S=async()=>{if(r){const m=await O(r.lat,r.lng);t.setFieldValue("address",m),o(!1)}else alert("Please select a location on the map first.")};return a.useEffect(()=>{var m;if(g&&((m=g.geometry)!=null&&m.location)){const b={lat:g.geometry.location.lat(),lng:g.geometry.location.lng()};s(b),i(b)}},[g]),a.useEffect(()=>{var m;if(g&&((m=g.geometry)!=null&&m.location)){const b={lat:g.geometry.location.lat(),lng:g.geometry.location.lng()};s(b),i(b)}},[g]),y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsx("label",{htmlFor:"address",className:"block text-[18px] font-[500] text-[#252C62]",children:e}),y.jsx("input",{className:`${u?"cursor-wait":"cursor-pointer"} border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full`,type:"text",name:"address",id:"address",placeholder:u?"Loading Map...":"Select Address",value:t.values.address,readOnly:!0,onClick:async()=>{u||d||(o(!0),f(!1),await A(),f(!1))},disabled:u||d}),y.jsx(ee,{name:"address",component:"div",className:"text-sm text-red-500"})]}),n&&y.jsx("div",{className:"address-input-modal",onClick:k,children:y.jsxs("div",{className:"address-map-container",children:[y.jsxs("div",{className:"address-map",children:[l&&r&&y.jsxs(ge,{apiKey:M,children:[y.jsx(Y,{mapId:"address-map",defaultCenter:l,defaultZoom:16,gestureHandling:"greedy",children:y.jsx(Re,{ref:c,position:r,draggable:!0,onDragEnd:w})}),y.jsx(Ue,{position:Ge.LEFT_TOP,children:y.jsx("div",{className:"ml-[10px]",children:y.jsx(qe,{onPlaceSelect:h})})}),y.jsx(Ze,{place:g})]}),!l&&!r&&y.jsx("p",{children:"Loading map..."})]}),y.jsxs("div",{className:"flex items-center justify-end gap-5 mt-4",children:[" ",y.jsx("div",{children:y.jsx("button",{type:"button",className:"px-4 py-2 rounded-[8px] bg-[#4C63BD] text-white cursor-pointer disabled:opacity-50",onClick:S,disabled:!r||d,children:d?"Loading...":"Select Address"})}),y.jsx("div",{children:y.jsx("button",{type:"button",className:"px-4 py-2 rounded-[8px] bg-white border border-[#AEC8E2] cursor-pointer",onClick:()=>{o(!1)},disabled:d,children:"Cancel"})})]})]})})]})}const Ze=({place:t})=>{const e=R();return a.useEffect(()=>{var n;!e||!t||!((n=t.geometry)!=null&&n.viewport)||e.fitBounds(t.geometry.viewport)},[e,t]),null},qe=({onPlaceSelect:t})=>{const[e,n]=a.useState(null),o=a.useRef(null),r=Q("places");return a.useEffect(()=>{if(!r||!o.current)return;const s={fields:["geometry","name","formatted_address"]};n(new r.Autocomplete(o.current,s))},[r]),a.useEffect(()=>{e&&e.addListener("place_changed",()=>{t(e.getPlace())})},[t,e]),y.jsxs("div",{className:"flex items-center border border-gray-300 bg-white text-black rounded-[20px]",children:[y.jsx("span",{className:"pl-2 text-gray-500",children:y.jsx(te,{})}),y.jsx("input",{ref:o,className:"w-[175px] py-2 px-2 outline-none",type:"search",name:"search",id:"search","aria-label":"Search",placeholder:"Search"})]})};export{Ye as A};
