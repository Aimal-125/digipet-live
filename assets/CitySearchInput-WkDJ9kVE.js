import{w as re,r,R as P,j as C,E as V}from"./index-MSo7KKZK.js";import{r as J}from"./index-DGCYGOKv.js";import{I as ae}from"./index-DG2D3s3o.js";var H,Z;function le(){return Z||(Z=1,H=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var s,o,a;if(Array.isArray(e)){if(s=e.length,s!=n.length)return!1;for(o=s;o--!==0;)if(!t(e[o],n[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),s=a.length,s!==Object.keys(n).length)return!1;for(o=s;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[o]))return!1;for(o=s;o--!==0;){var c=a[o];if(!t(e[c],n[c]))return!1}return!0}return e!==e&&n!==n}),H}var ie=le();const ce=re(ie);function k(){return k=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},k.apply(null,arguments)}function F(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function de(t){var e=ue(t,"string");return typeof e=="symbol"?e:e+""}const _={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},fe="https://maps.googleapis.com/maps/api/js";class z{static async load(e,n){var s;const o=e.libraries?e.libraries.split(","):[],a=this.serializeParams(e);this.listeners.push(n),(s=window.google)!=null&&(s=s.maps)!=null&&s.importLibrary?(this.serializedApiParams||(this.loadingStatus=_.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=a,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==a&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const c=["maps",...o];await Promise.all(c.map(l=>google.maps.importLibrary(l)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const s=()=>n||(n=new Promise((o,a)=>{var c;const l=document.createElement("script"),g=new URLSearchParams;for(const[v,f]of Object.entries(e)){const y=v.replace(/[A-Z]/g,h=>"_"+h[0].toLowerCase());g.set(y,String(f))}g.set("loading","async"),g.set("callback","__googleMapsCallback__"),l.async=!0,l.src=fe+"?"+g.toString(),l.nonce=((c=document.querySelector("script[nonce]"))==null?void 0:c.nonce)||"",l.onerror=()=>{this.loadingStatus=_.FAILED,this.notifyLoadingStatusListeners(),a(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=_.LOADED,this.notifyLoadingStatusListeners(),o()},window.gm_authFailure=()=>{this.loadingStatus=_.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=_.LOADING,this.notifyLoadingStatusListeners(),document.head.append(l)}),n);google.maps.importLibrary=o=>s().then(()=>google.maps.importLibrary(o))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}z.loadingStatus=_.NOT_LOADED;z.serializedApiParams=void 0;z.listeners=[];const ge=["onLoad","onError","apiKey","version","libraries"],pe=["children"],he="GMP_visgl_rgmlibrary_v1_default",R=P.createContext(null);function me(){const[t,e]=r.useState({});return{mapInstances:t,addMapInstance:(a,c="default")=>{e(l=>k({},l,{[c]:a}))},removeMapInstance:(a="default")=>{e(c=>F(c,[a].map(de)))},clearMapInstances:()=>{e({})}}}function ve(t){const{onLoad:e,onError:n,apiKey:s,version:o,libraries:a=[]}=t,c=F(t,ge),[l,g]=r.useState(z.loadingStatus),[v,f]=r.useReducer((d,b)=>d[b.name]?d:k({},d,{[b.name]:b.value}),{}),y=r.useMemo(()=>a==null?void 0:a.join(","),[a]),h=r.useMemo(()=>JSON.stringify(k({apiKey:s,version:o},c)),[s,o,c]),w=r.useCallback(async d=>{var b;if(v[d])return v[d];if(!((b=google)!=null&&(b=b.maps)!=null&&b.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const x=await window.google.maps.importLibrary(d);return f({name:d,value:x}),x},[v]);return r.useEffect(()=>{(async()=>{try{const d=k({key:s},c);o&&(d.v=o),(y==null?void 0:y.length)>0&&(d.libraries=y),(d.channel===void 0||d.channel<0||d.channel>999)&&delete d.channel,d.solutionChannel===void 0?d.solutionChannel=he:d.solutionChannel===""&&delete d.solutionChannel,await z.load(d,b=>g(b));for(const b of["core","maps",...a])await w(b);e&&e()}catch(d){n?n(d):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",d)}})()},[s,y,h]),{status:l,loadedLibraries:v,importLibrary:w}}const ye=t=>{const{children:e}=t,n=F(t,pe),{mapInstances:s,addMapInstance:o,removeMapInstance:a,clearMapInstances:c}=me(),{status:l,loadedLibraries:g,importLibrary:v}=ve(n),f=r.useMemo(()=>({mapInstances:s,addMapInstance:o,removeMapInstance:a,clearMapInstances:c,status:l,loadedLibraries:g,importLibrary:v}),[s,o,a,c,l,g,v]);return P.createElement(R.Provider,{value:f},e)};function Ce(t,e){for(const n of xe){const s=e[n],o=W[n];r.useEffect(()=>{if(!t||!s)return;const a=google.maps.event.addListener(t,o,c=>{s(be(o,t,c))});return()=>a.remove()},[t,o,s])}}function be(t,e,n){const s={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(Ee.includes(t)){const a=s,c=e.getCenter(),l=e.getZoom(),g=e.getHeading()||0,v=e.getTilt()||0,f=e.getBounds();return(!c||!f||!Number.isFinite(l))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),a.detail={center:(c==null?void 0:c.toJSON())||{lat:0,lng:0},zoom:l||0,heading:g,tilt:v,bounds:(f==null?void 0:f.toJSON())||{north:90,east:180,south:-90,west:-180}},a}else if(we.includes(t)){var o;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const a=s;return a.domEvent=n.domEvent,a.stoppable=!0,a.stop=()=>n.stop(),a.detail={latLng:((o=n.latLng)==null?void 0:o.toJSON())||null,placeId:n.placeId},a}return s}const W={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},Ee=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],we=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],xe=Object.keys(W);function Le(t,e){const n=r.useRef(void 0);(!n.current||!ce(e,n.current))&&(n.current=e),r.useEffect(t,n.current)}const Se=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function Ae(t,e){const n={},s=Object.keys(e);for(const o of s)Se.has(o)&&(n[o]=e[o]);Le(()=>{t&&t.setOptions(n)},[n])}function Y(){var t;return((t=r.useContext(R))==null?void 0:t.status)||_.NOT_LOADED}function Me(t,e){const{viewport:n,viewState:s}=e,o=!!n;return r.useLayoutEffect(()=>{if(!t||!s)return;const{latitude:a,longitude:c,bearing:l,pitch:g,zoom:v}=s;t.moveCamera({center:{lat:a,lng:c},heading:l,tilt:g,zoom:v+1})},[t,s]),o}function Ie(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function Q(t){return Ie(t)?t:t.toJSON()}function Oe(t,e,n){const s=n.center?Q(n.center):null;let o=null,a=null;s&&Number.isFinite(s.lat)&&Number.isFinite(s.lng)&&(o=s.lat,a=s.lng);const c=Number.isFinite(n.zoom)?n.zoom:null,l=Number.isFinite(n.heading)?n.heading:null,g=Number.isFinite(n.tilt)?n.tilt:null;r.useLayoutEffect(()=>{if(!t)return;const v={};let f=!1;o!==null&&a!==null&&(e.current.center.lat!==o||e.current.center.lng!==a)&&(v.center={lat:o,lng:a},f=!0),c!==null&&e.current.zoom!==c&&(v.zoom=c,f=!0),l!==null&&e.current.heading!==l&&(v.heading=l,f=!0),g!==null&&e.current.tilt!==g&&(v.tilt=g,f=!0),f&&t.moveCamera(v)})}const Pe=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return P.createElement("div",{style:t},P.createElement("h2",null,"Error: AuthFailure"),P.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",P.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function De(){const[t,e]=r.useState(null),n=r.useCallback(s=>e(s),[e]);return[t,n]}function X(){return Y()===_.LOADED}function ke(){const[,t]=r.useReducer(e=>e+1,0);return t}function _e(t,e){const n=t.getCenter(),s=t.getZoom(),o=t.getHeading()||0,a=t.getTilt()||0,c=t.getBounds();(!n||!c||!Number.isFinite(s))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:(n==null?void 0:n.toJSON())||{lat:0,lng:0},zoom:s||0,heading:o,tilt:a})}function Te(t){const e=ke(),n=r.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return r.useEffect(()=>{if(!t)return;const s=google.maps.event.addListener(t,"bounds_changed",()=>{_e(t,n),e()});return()=>s.remove()},[t,e]),n}const je=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],Fe=["padding"];class U{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}U.entries={};function Ne(t,e){const n=X(),[s,o]=r.useState(null),[a,c]=De(),l=Te(s),{id:g,defaultBounds:v,defaultCenter:f,defaultZoom:y,defaultHeading:h,defaultTilt:w,reuseMaps:d,renderingType:b,colorScheme:x}=t,E=F(t,je),S=t.zoom!==void 0||t.defaultZoom!==void 0,A=t.center!==void 0||t.defaultCenter!==void 0;!v&&(!S||!A)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!E.center&&f&&(E.center=f),!E.zoom&&Number.isFinite(y)&&(E.zoom=y),!E.heading&&Number.isFinite(h)&&(E.heading=h),!E.tilt&&Number.isFinite(w)&&(E.tilt=w);for(const M of Object.keys(E))E[M]===void 0&&delete E[M];const O=r.useRef(void 0);return r.useEffect(()=>{if(!a||!n)return;const{addMapInstance:M,removeMapInstance:I}=e,{mapId:u}=t,p=`${u||"default"}:${b||"default"}:${x||"LIGHT"}`;let i,m;if(d&&U.has(p)?(m=U.pop(p),i=m.getDiv(),a.appendChild(i),m.setOptions(E),setTimeout(()=>m.setCenter(m.getCenter()),0)):(i=document.createElement("div"),i.style.height="100%",a.appendChild(i),m=new google.maps.Map(i,k({},E,b?{renderingType:b}:{},x?{colorScheme:x}:{}))),o(m),M(m,g),v){const{padding:L}=v,D=F(v,Fe);m.fitBounds(D,L)}else(!S||!A)&&m.fitBounds({east:180,west:-180,south:-90,north:90});if(O.current){const{mapId:L,cameraState:D}=O.current;L!==u&&m.setOptions(D)}return()=>{O.current={mapId:u,cameraState:l.current},i.remove(),d?U.push(p,m):google.maps.event.clearInstanceListeners(m),o(null),I(g)}},[a,n,g,t.mapId,t.renderingType,t.colorScheme]),[s,c,l]}const ee=P.createContext(null),te=t=>{const{children:e,id:n,className:s,style:o}=t,a=r.useContext(R),c=Y();if(!a)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[l,g,v]=Ne(t,a);Oe(l,v,t),Ce(l,t),Ae(l,t);const f=Me(l,t),y=!!t.controlled;r.useEffect(()=>{if(l)return f&&l.setOptions({disableDefaultUI:!0}),(f||y)&&l.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{l.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[l,f,y,t.gestureHandling,t.keyboardShortcuts]);const h=t.center?Q(t.center):null;let w=null,d=null;h&&Number.isFinite(h.lat)&&Number.isFinite(h.lng)&&(w=h.lat,d=h.lng);const b=r.useMemo(()=>{var S,A,O,M,I;return{center:{lat:(S=w)!=null?S:0,lng:(A=d)!=null?A:0},zoom:(O=t.zoom)!=null?O:0,heading:(M=t.heading)!=null?M:0,tilt:(I=t.tilt)!=null?I:0}},[w,d,t.zoom,t.heading,t.tilt]);r.useLayoutEffect(()=>{if(!l||!y)return;l.moveCamera(b);const S=l.addListener("bounds_changed",()=>{l.moveCamera(b)});return()=>S.remove()},[l,y,b]);const x=r.useMemo(()=>k({width:"100%",height:"100%",position:"relative",zIndex:f?-1:0},o),[o,f]),E=r.useMemo(()=>({map:l}),[l]);return c===_.AUTH_FAILURE?P.createElement("div",{style:k({position:"relative"},s?{}:x),className:s},P.createElement(Pe,null)):P.createElement("div",k({ref:g,"data-testid":"map",style:s?void 0:x,className:s},n?{id:n}:{}),l?P.createElement(ee.Provider,{value:E},e):null)};te.deckGLViewProps=!0;const q=new Set;function ze(...t){const e=JSON.stringify(t);q.has(e)||(q.add(e),console.error(...t))}const G=(t=null)=>{const e=r.useContext(R),{map:n}=r.useContext(ee)||{};if(e===null)return ze("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:s}=e;return t!==null?s[t]||null:n||s.default||null};function ne(t){const e=X(),n=r.useContext(R);return r.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),(n==null?void 0:n.loadedLibraries[t])||null}function $(t,e,n){r.useEffect(()=>{if(!t||!e||!n)return;const s=google.maps.event.addListener(t,e,n);return()=>s.remove()},[t,e,n])}function B(t,e,n){r.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function K(t,e,n){r.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function Re(t){return t.nodeType===Node.ELEMENT_NODE}const $e=P.createContext(null),Be={BOTTOM:["50%","100%"]},Ue=({children:t,styles:e,className:n,anchorPoint:s})=>{const[o,a]=s??Be.BOTTOM;let c=`-${o}`,l=`-${a}`;o.trimStart().startsWith("-")&&(c=o.substring(1)),a.trimStart().startsWith("-")&&(l=a.substring(1));const g=`translate(50%, 100%) translate(${c}, ${l})`;return P.createElement("div",{style:{transform:g}},P.createElement("div",{className:n,style:e},t))};function Ge(t){const[e,n]=r.useState(null),[s,o]=r.useState(null),a=G(),c=ne("marker"),{children:l,onClick:g,className:v,onMouseEnter:f,onMouseLeave:y,onDrag:h,onDragStart:w,onDragEnd:d,collisionBehavior:b,clickable:x,draggable:E,position:S,title:A,zIndex:O}=t,M=r.Children.count(l);return r.useEffect(()=>{if(!a||!c)return;const I=new c.AdvancedMarkerElement;I.map=a,n(I);let u=null;return M>0&&(u=document.createElement("div"),u.isCustomMarker=!0,I.content=u,o(u)),()=>{var p;I.map=null,(p=u)==null||p.remove(),n(null),o(null)}},[a,c,M]),r.useEffect(()=>{!e||!e.content||M>0||(e.content.className=v||"")},[e,v,M]),B(e,"position",S),B(e,"title",A??""),B(e,"zIndex",O),B(e,"collisionBehavior",b),r.useEffect(()=>{e&&(E!==void 0?e.gmpDraggable=E:h||w||d?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,E,h,d,w]),r.useEffect(()=>{if(!e)return;const I=x!==void 0||!!g||!!f||!!y;e.gmpClickable=I,I&&e!=null&&e.content&&Re(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,x,g,f,y]),$(e,"click",g),$(e,"drag",h),$(e,"dragstart",w),$(e,"dragend",d),K(e==null?void 0:e.element,"mouseenter",f),K(e==null?void 0:e.element,"mouseleave",y),[e,s]}const He=r.forwardRef((t,e)=>{const{children:n,style:s,className:o,anchorPoint:a}=t,[c,l]=Ge(t),g=r.useMemo(()=>c?{marker:c}:null,[c]);return r.useImperativeHandle(e,()=>c,[c]),l?P.createElement($e.Provider,{value:g},J.createPortal(P.createElement(Ue,{anchorPoint:a,styles:s,className:o},n),l)):null});function Ve(){const[t,e]=r.useState(null);return[r.useCallback(s=>{e(s)},[]),t]}const Ze={LEFT_TOP:5},qe=({children:t,position:e})=>{const n=r.useMemo(()=>document.createElement("div"),[]),s=G();return r.useEffect(()=>{if(!s)return;const o=s.controls[e];return o.push(n),()=>{const a=o.getArray();if(!a)return;const c=a.indexOf(n);o.removeAt(c)}},[n,s,e]),J.createPortal(t,n)},Ke=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function Je(t){const[e,n]=r.useState(null),s=G(),{onClick:o,onDrag:a,onDragStart:c,onDragEnd:l,onMouseOver:g,onMouseOut:v}=t,f=F(t,Ke),{position:y,draggable:h}=f;return r.useEffect(()=>{if(!s){s===void 0&&console.error("<Marker> has to be inside a Map component.");return}const w=new google.maps.Marker(f);return w.setMap(s),n(w),()=>{w.setMap(null),n(null)}},[s]),r.useEffect(()=>{if(!e)return;const w=e,d=google.maps.event;return o&&d.addListener(w,"click",o),a&&d.addListener(w,"drag",a),c&&d.addListener(w,"dragstart",c),l&&d.addListener(w,"dragend",l),g&&d.addListener(w,"mouseover",g),v&&d.addListener(w,"mouseout",v),e.setDraggable(!!h),()=>{d.clearInstanceListeners(w)}},[e,h,o,a,c,l,g,v]),r.useEffect(()=>{e&&f&&e.setOptions(f)},[e,f]),r.useEffect(()=>{h||!y||!e||e.setPosition(y)},[h,y,e]),e}r.forwardRef((t,e)=>{const n=Je(t);return r.useImperativeHandle(e,()=>n,[n]),P.createElement(P.Fragment,null)});function tt({formik:t,label:e="Address"}){const[n,s]=r.useState(!1),[o,a]=r.useState(null),[c,l]=r.useState(null),[g,v]=r.useState(!1),[f,y]=r.useState(!1),[h,w]=r.useState(null),[d,b]=Ve(),x="AIzaSyDIBfIEiwZqaEBV1N2DbCogGhHLfsyhR6c",E={lat:40.7128,lng:-74.006},S=()=>new Promise(u=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(p=>{const i={lat:p.coords.latitude,lng:p.coords.longitude};a(i),l(i),u(i)},p=>{console.error("Geolocation error:",p),a(E),l(E),alert("Could not retrieve your location. Using a default location."),u(E)}):(a(E),l(E),alert("Geolocation is not supported by your browser. Using a default location."),u(E))}),A=async(u,p)=>{if(!u||!p)return console.error("Invalid coordinates for geocoding"),"Could not determine address";y(!0);try{const i=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${u},${p}&key=${x}`);if(!i.ok)throw new Error(`Geocoding API request failed: ${i.statusText}`);const m=await i.json();if(m.status==="OK"&&m.results&&m.results.length>0){const L=m.results[0].formatted_address;return console.log("Geocoding result:",L),y(!1),L}else return console.error("Geocoding failed:",m.status,m.error_message),y(!1),`Address not found (${m.status})`}catch(i){return console.error("Error during geocoding fetch:",i),y(!1),"Geocoding request failed"}},O=u=>{u.target.classList.contains("address-input-modal")&&s(!1)},M=r.useCallback(u=>{if(u.latLng){const p={lat:u.latLng.lat(),lng:u.latLng.lng()};console.log("Marker dragged to:",p),a(p)}},[]),I=async()=>{if(o){const u=await A(o.lat,o.lng);t.setFieldValue("address",u),s(!1)}else alert("Please select a location on the map first.")};return r.useEffect(()=>{var u;if(h&&((u=h.geometry)!=null&&u.location)){const p={lat:h.geometry.location.lat(),lng:h.geometry.location.lng()};a(p),l(p)}},[h]),r.useEffect(()=>{var u;if(h&&((u=h.geometry)!=null&&u.location)){const p={lat:h.geometry.location.lat(),lng:h.geometry.location.lng()};a(p),l(p)}},[h]),C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"flex flex-col gap-3",children:[C.jsx("label",{htmlFor:"address",className:"block text-[18px] font-[500] text-[#252C62]",children:e}),C.jsx("input",{className:`${g?"cursor-wait":"cursor-pointer"} border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full`,type:"text",name:"address",id:"address",placeholder:g?"Loading Map...":"Select Address",value:t.values.address,readOnly:!0,onClick:async()=>{g||f||(s(!0),v(!1),await S(),v(!1))},disabled:g||f}),C.jsx(V,{name:"address",component:"div",className:"text-sm text-red-500"})]}),n&&C.jsx("div",{className:"address-input-modal",onClick:O,children:C.jsxs("div",{className:"address-map-container",children:[C.jsxs("div",{className:"address-map",children:[c&&o&&C.jsxs(ye,{apiKey:x,children:[C.jsx(te,{mapId:"address-map",defaultCenter:c,defaultZoom:16,gestureHandling:"greedy",children:C.jsx(He,{ref:d,position:o,draggable:!0,onDragEnd:M})}),C.jsx(qe,{position:Ze.LEFT_TOP,children:C.jsx("div",{className:"ml-[10px]",children:C.jsx(Ye,{onPlaceSelect:w})})}),C.jsx(We,{place:h})]}),!c&&!o&&C.jsx("p",{children:"Loading map..."})]}),C.jsxs("div",{className:"flex items-center justify-end gap-5 mt-4",children:[" ",C.jsx("div",{children:C.jsx("button",{type:"button",className:"px-4 py-2 rounded-[8px] bg-[#4C63BD] text-white cursor-pointer disabled:opacity-50",onClick:I,disabled:!o||f,children:f?"Loading...":"Select Address"})}),C.jsx("div",{children:C.jsx("button",{type:"button",className:"px-4 py-2 rounded-[8px] bg-white border border-[#AEC8E2] cursor-pointer",onClick:()=>{s(!1)},disabled:f,children:"Cancel"})})]})]})})]})}const We=({place:t})=>{const e=G();return r.useEffect(()=>{var n;!e||!t||!((n=t.geometry)!=null&&n.viewport)||e.fitBounds(t.geometry.viewport)},[e,t]),null},Ye=({onPlaceSelect:t})=>{const[e,n]=r.useState(null),s=r.useRef(null),o=ne("places");return r.useEffect(()=>{if(!o||!s.current)return;const a={fields:["geometry","name","formatted_address"]};n(new o.Autocomplete(s.current,a))},[o]),r.useEffect(()=>{e&&e.addListener("place_changed",()=>{t(e.getPlace())})},[t,e]),C.jsxs("div",{className:"flex items-center border border-gray-300 bg-white text-black rounded-[20px]",children:[C.jsx("span",{className:"pl-2 text-gray-500",children:C.jsx(ae,{})}),C.jsx("input",{ref:s,className:"w-[175px] py-2 px-2 outline-none",type:"search",name:"search",id:"search","aria-label":"Search",placeholder:"Search"})]})},T={},nt=({formik:t,name:e="",id:n="",label:s="",countryName:o="",getStateName:a=()=>{}})=>{const[c,l]=r.useState(""),[g,v]=r.useState([]),[f,y]=r.useState([]),[h,w]=r.useState(!1),[d,b]=r.useState(-1),[x,E]=r.useState(!1),S=r.useRef(null),A=r.useRef(null);r.useEffect(()=>{(async()=>{if(!o){v([]),y([]),l(""),E(!1);return}if(T[o]){if(console.log(`Using states for ${o} from cache.`),v(T[o]),c){const i=T[o].filter(m=>m.name.toLowerCase().includes(c.toLowerCase()));y(i)}else y([]);const p=t.values[e];l(p||""),E(!1);return}console.log(`Fetching states for ${o} from API.`),E(!0),v([]),y([]);try{const p=await fetch("https://countriesnow.space/api/v0.1/countries/states",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({country:o})});if(!p.ok){console.error(`HTTP error fetching states: ${p.status}`),v([]),y([]),T[o]=[];return}const i=await p.json();i.error||!i.data||!i.data.states?i.data&&i.data.states?(v(i.data.states),T[o]=i.data.states):(console.error("API error fetching states:",i.msg||"Unexpected API response structure"),v([]),y([]),T[o]=[]):(v(i.data.states),T[o]=i.data.states)}catch(p){console.error("Error fetching states:",p),v([]),y([]),T[o]=[]}finally{E(!1);const p=t.values[e];l(p||"")}})()},[o,t.values,c,e]),r.useEffect(()=>{const u=t.values[e];typeof u=="string"?l(u):u||l("")},[t.values,e]);const O=u=>{const p=u.target.value;if(l(p),b(-1),p.length>0&&g.length>0){const i=g.filter(m=>m.name.toLowerCase().includes(p.toLowerCase()));y(i),w(!0)}else y([]),w(!1)},M=u=>{l(u.name),t.setFieldValue(e,u.name),a(u.name),y([]),w(!1),b(-1),t.setFieldTouched(e,!0)},I=u=>{!h||f.length===0||(u.key==="ArrowUp"?(u.preventDefault(),b(p=>p<=0?f.length-1:p-1)):u.key==="ArrowDown"?(u.preventDefault(),b(p=>p===f.length-1?0:p+1)):u.key==="Enter"?(u.preventDefault(),d>=0&&d<f.length&&M(f[d])):u.key==="Escape"&&(w(!1),b(-1),t.setFieldTouched(e,!0)))};return r.useEffect(()=>{const u=p=>{S.current&&!S.current.contains(p.target)&&A.current&&!A.current.contains(p.target)&&(w(!1),b(-1),t.setFieldTouched(e,!0))};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[t,e]),r.useEffect(()=>{if(d!==-1&&A.current){const u=A.current.children[d];u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}},[d,f.length]),C.jsxs("div",{className:"relative flex flex-col gap-3",children:[s&&C.jsx("label",{htmlFor:n,className:"block text-[18px] font-[500] text-[#252C62]",children:s}),C.jsx("input",{ref:S,type:"text",id:n,name:e,value:t==null?void 0:t.values[e],onChange:u=>{t.handleChange(u),O(u)},onKeyDown:I,onFocus:()=>{if(o&&g.length>0){if(c.length>0){const u=g.filter(p=>p.name.toLowerCase().includes(c.toLowerCase()));y(u)}else y(g);w(!0)}},onBlur:u=>{t.handleBlur(u),setTimeout(()=>{w(!1),b(-1)},100)},placeholder:x&&o?"Loading...":o?"Search for a state or province...":"Select a country first...",disabled:!o||x,className:`border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full ${!o||x?"bg-gray-100 cursor-not-allowed":""}`}),h&&f.length>0&&C.jsx("ul",{ref:A,className:"absolute left-0 top-[100%] z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto shadow-lg",children:f.map((u,p)=>C.jsx("li",{className:`px-4 py-2 cursor-pointer ${p===d?"bg-blue-100":"hover:bg-gray-100"}`,onClick:()=>M(u),onMouseDown:i=>i.preventDefault(),children:u.name},u.code||u.name||p))}),h&&f.length===0&&c.length>0&&!x&&C.jsx("div",{className:"absolute left-0 top-[100%] z-10 w-full bg-white border border-gray-300 rounded-md mt-1 px-4 py-2 text-gray-600 shadow-lg",children:"No matching states found."}),C.jsx(V,{name:e,component:"div",className:"text-red-500 text-sm mt-1"})]})},j={},ot=({formik:t,name:e="",id:n="",label:s="",countryName:o="",stateName:a="",getCityName:c=()=>{}})=>{const[l,g]=r.useState(""),[v,f]=r.useState([]),[y,h]=r.useState([]),[w,d]=r.useState(!1),[b,x]=r.useState(-1),[E,S]=r.useState(!1),A=r.useRef(null),O=r.useRef(null);r.useEffect(()=>{(async()=>{if(!o||!a){f([]),h([]),g(""),S(!1);return}const m=`${o}_${a}`;if(j[m]){if(console.log(`Using cities for ${o}, ${a} from cache.`),f(j[m]),l){const D=j[m].filter(N=>N.toLowerCase().includes(l.toLowerCase()));h(D)}else h([]);const L=t.values[e];g(L||""),S(!1);return}console.log(`Fetching cities for ${o}, ${a} from API.`),S(!0),f([]),h([]);try{const L=await fetch("https://countriesnow.space/api/v0.1/countries/state/cities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({country:o,state:a})});if(!L.ok){console.error(`HTTP error fetching cities: ${L.status}`),f([]),h([]),j[m]=[];return}const D=await L.json();if(D.error||!D.data)console.error("API error fetching cities:",D.msg||"Unexpected API response structure or no cities found"),f([]),h([]),j[m]=[];else{const N=D.data||[];if(f(N),j[m]=N,l){const oe=N.filter(se=>se.toLowerCase().includes(l.toLowerCase()));h(oe)}else h([])}}catch(L){console.error("Error fetching cities:",L),f([]),h([]),j[m]=[]}finally{S(!1);const L=t.values[e];g(L||"")}})()},[o,a,t.values,l,e]),r.useEffect(()=>{const i=t.values[e];typeof i=="string"?g(i):i||g("")},[t.values,e]);const M=i=>{const m=i.target.value;if(g(m),x(-1),m.length>0&&v.length>0){const L=v.filter(D=>D.toLowerCase().includes(m.toLowerCase()));h(L),d(!0)}else h([]),d(!1)},I=i=>{g(i),t.setFieldValue(e,i),h([]),d(!1),x(-1),t.setFieldTouched(e,!0),typeof c=="function"&&c(i)},u=i=>{!w||y.length===0||(i.key==="ArrowUp"?(i.preventDefault(),x(m=>m<=0?y.length-1:m-1)):i.key==="ArrowDown"?(i.preventDefault(),x(m=>m===y.length-1?0:m+1)):i.key==="Enter"?(i.preventDefault(),b>=0&&b<y.length&&I(y[b])):i.key==="Escape"&&(d(!1),x(-1),t.setFieldTouched(e,!0)))};r.useEffect(()=>{const i=m=>{A.current&&!A.current.contains(m.target)&&O.current&&!O.current.contains(m.target)&&(d(!1),x(-1),t.setFieldTouched(e,!0))};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[t,e]),r.useEffect(()=>{if(b!==-1&&O.current){const i=O.current.children[b];i&&i.scrollIntoView({behavior:"smooth",block:"nearest"})}},[b,y.length]);const p=!o||!a||E;return C.jsxs("div",{className:"relative flex flex-col gap-3",children:[s&&C.jsx("label",{htmlFor:n,className:"block text-[18px] font-[500] text-[#252C62]",children:s}),C.jsx("input",{ref:A,type:"text",id:n,name:e,value:t==null?void 0:t.values[e],onChange:i=>{t.handleChange(i),M(i)},onKeyDown:u,onFocus:()=>{if(o&&a&&v.length>0){const i=v.filter(m=>m.toLowerCase().includes(l.toLowerCase()));h(i),d(!0)}else o&&a&&!E&&(h([]),d(!0))},onBlur:i=>{t.handleBlur(i),setTimeout(()=>{d(!1),x(-1)},100)},placeholder:E?"Loading cities...":o?a?"Search for a city...":"Select a state/province first...":"Select a country first...",disabled:p,className:`border border-[#AEC8E2] rounded-[6px] px-4 py-2 w-full ${p?"bg-gray-100 cursor-not-allowed":""}`}),w&&(y.length>0||l.length>0&&!E||E)&&C.jsx("ul",{ref:O,className:"absolute left-0 top-[100%] z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto shadow-lg",children:E&&l.length===0?C.jsx("li",{className:"px-4 py-2 text-gray-600",children:"Loading cities..."}):y.length>0?y.map((i,m)=>C.jsx("li",{className:`px-4 py-2 cursor-pointer ${m===b?"bg-blue-100":"hover:bg-gray-100"}`,onClick:()=>I(i),onMouseDown:L=>L.preventDefault(),children:i},i+m)):!E&&l.length>0&&C.jsx("li",{className:"px-4 py-2 text-gray-600",children:"No matching cities found."})}),C.jsx(V,{name:e,component:"div",className:"text-red-500 text-sm mt-1"})]})};export{tt as A,ot as C,nt as S};
